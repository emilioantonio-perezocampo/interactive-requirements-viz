<html>
    <head>
        <meta charset="utf-8">
        
            <script src="lib/bindings/utils.js"></script>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/dist/vis-network.min.css" integrity="sha512-WgxfT5LWjfszlPHXRmBWHkV2eceiWTOBvrKCNbdgDYTHrT2AeLCGbF4sZlZw3UMN3WtL0tGUoIAKsu8mllg/XA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
            <script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/vis-network.min.js" integrity="sha512-LnvoEWDFrqGHlHmDD2101OrLcbsfkrzoSpvtSQtxK3RMnRV0eOkhhBN2dXHKRrUU8p2DGRTk35n4O8nWSVe1mQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            
        
<center>
<h1></h1>
</center>

<!-- <link rel="stylesheet" href="../node_modules/vis/dist/vis.min.css" type="text/css" />
<script type="text/javascript" src="../node_modules/vis/dist/vis.js"> </script>-->
        <link
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
          crossorigin="anonymous"
        />
        <script
          src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
          crossorigin="anonymous"
        ></script>


        <center>
          <h1></h1>
        </center>
        <style type="text/css">

             #mynetwork {
                 width: 100%;
                 height: 900px;
                 background-color: #1a1a2e;
                 border: 1px solid lightgray;
                 position: relative;
                 float: left;
             }

             

             

             
        </style>
    
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #1a1a2e;
            overflow: hidden;
        }

        /* Main layout */
        .app-container {
            display: flex;
            height: 100vh;
            width: 100vw;
        }

        .left-panel {
            width: 320px;
            min-width: 320px;
            background: linear-gradient(180deg, #16213e 0%, #1a1a2e 100%);
            border-right: 1px solid #4a4a6a;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .graph-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .right-panel {
            width: 400px;
            min-width: 400px;
            background: linear-gradient(180deg, #16213e 0%, #1a1a2e 100%);
            border-left: 1px solid #4a4a6a;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Header */
        .panel-header {
            padding: 15px;
            border-bottom: 1px solid #4a4a6a;
            background: rgba(0,0,0,0.2);
        }

        .panel-header h2 {
            color: #00ff88;
            margin: 0;
            font-size: 1.1em;
            font-weight: 600;
        }

        .app-title {
            color: #00ff88;
            margin: 0 0 5px 0;
            font-size: 1.2em;
            font-weight: 600;
        }

        .app-subtitle {
            color: #8888aa;
            margin: 0;
            font-size: 0.8em;
        }

        /* Controls section */
        .controls-section {
            padding: 15px;
            border-bottom: 1px solid #3a3a5a;
        }

        .controls-section h3 {
            color: #00ff88;
            margin: 0 0 12px 0;
            font-size: 0.95em;
            font-weight: 600;
        }

        .control-row {
            margin-bottom: 12px;
        }

        .control-row:last-child {
            margin-bottom: 0;
        }

        .control-row label {
            display: block;
            color: #8888aa;
            font-size: 0.8em;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .control-row select,
        .control-row input[type="text"] {
            width: 100%;
            background: #0f0f23;
            border: 1px solid #4a4a6a;
            color: #ffffff;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9em;
        }

        .control-row select:hover,
        .control-row input:hover {
            border-color: #00ff88;
        }

        .control-row select:focus,
        .control-row input:focus {
            outline: none;
            border-color: #00ff88;
            box-shadow: 0 0 10px rgba(0,255,136,0.3);
        }

        /* Buttons */
        .btn {
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            border: none;
            color: #1a1a2e;
            padding: 10px 16px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.85em;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(0,255,136,0.4);
        }

        .btn-secondary {
            background: #4a4a6a;
            color: #ffffff;
        }

        .btn-secondary:hover {
            background: #5a5a7a;
            box-shadow: none;
        }

        .btn-group {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .btn-group .btn {
            flex: 1;
        }

        /* Layout toggle */
        .layout-toggle {
            display: flex;
            gap: 0;
            border-radius: 6px;
            overflow: hidden;
            border: 1px solid #4a4a6a;
        }

        .layout-btn {
            flex: 1;
            background: #0f0f23;
            border: none;
            color: #8888aa;
            padding: 10px 14px;
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .layout-btn:first-child {
            border-right: 1px solid #4a4a6a;
        }

        .layout-btn:hover {
            background: #1a1a3e;
            color: #ffffff;
        }

        .layout-btn.active {
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            color: #1a1a2e;
            font-weight: 600;
        }

        /* Stats panel */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            padding: 15px;
        }

        .stat-box {
            background: rgba(0,0,0,0.2);
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #3a3a5a;
        }

        .stat-label {
            color: #8888aa;
            font-size: 0.75em;
            margin-bottom: 4px;
        }

        .stat-value {
            color: #ffffff;
            font-size: 1.3em;
            font-weight: 600;
        }

        /* Legend */
        .legend-container {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 4px 0;
            cursor: pointer;
            padding: 6px 8px;
            border-radius: 4px;
            transition: background 0.2s;
        }

        .legend-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .legend-color {
            width: 14px;
            height: 14px;
            border-radius: 3px;
            border: 1px solid rgba(255,255,255,0.3);
            flex-shrink: 0;
        }

        .legend-item span {
            color: #cccccc;
            font-size: 0.8em;
        }

        /* Graph container */
        #mynetwork {
            flex: 1;
            background-color: #1a1a2e;
            border: none !important;
        }

        /* Hover tooltip */
        #hover-tooltip {
            position: fixed;
            background: rgba(22, 33, 62, 0.98);
            padding: 15px 18px;
            border-radius: 10px;
            color: #ffffff;
            font-size: 0.85em;
            z-index: 2000;
            border: 1px solid #4a4a6a;
            max-width: 380px;
            pointer-events: none;
            display: none;
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
        }

        #hover-tooltip h4 {
            margin: 0 0 10px 0;
            color: #00ff88;
            font-size: 1em;
            border-bottom: 1px solid #4a4a6a;
            padding-bottom: 8px;
        }

        .tooltip-row {
            display: flex;
            margin: 5px 0;
            line-height: 1.4;
        }

        .tooltip-label {
            color: #8888aa;
            min-width: 90px;
            font-weight: 500;
            font-size: 0.9em;
        }

        .tooltip-value {
            color: #ffffff;
            flex: 1;
        }

        .tooltip-requisito {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #4a4a6a;
            line-height: 1.5;
            color: #ccccdd;
            font-size: 0.9em;
        }

        /* Data table */
        .table-header {
            padding: 15px;
            border-bottom: 1px solid #4a4a6a;
            background: rgba(0,0,0,0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-header h2 {
            color: #00ff88;
            margin: 0;
            font-size: 1em;
        }

        .table-count {
            color: #8888aa;
            font-size: 0.85em;
        }

        .table-container {
            flex: 1;
            overflow: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.8em;
        }

        .data-table th {
            background: rgba(0,0,0,0.3);
            color: #8888aa;
            padding: 10px 8px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            border-bottom: 1px solid #4a4a6a;
        }

        .data-table td {
            padding: 8px;
            border-bottom: 1px solid #2a2a4a;
            color: #cccccc;
            vertical-align: top;
        }

        .data-table tr:hover td {
            background: rgba(0,255,136,0.05);
        }

        .data-table .id-cell {
            color: #00ff88;
            font-weight: 600;
            white-space: nowrap;
        }

        .data-table .area-cell {
            white-space: nowrap;
        }

        .data-table .func-cell {
            max-width: 200px;
        }

        .priority-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.85em;
            font-weight: 500;
        }

        .priority-p0 {
            background: rgba(255,107,107,0.2);
            color: #ff6b6b;
        }

        .priority-p1 {
            background: rgba(255,217,61,0.2);
            color: #ffd93d;
        }

        .priority-p2 {
            background: rgba(78,205,196,0.2);
            color: #4ecdc4;
        }

        /* Selected node info */
        .selected-info {
            padding: 15px;
            background: rgba(0,255,136,0.05);
            border-bottom: 1px solid #4a4a6a;
            display: none;
        }

        .selected-info.visible {
            display: block;
        }

        .selected-info h3 {
            color: #00ff88;
            margin: 0 0 8px 0;
            font-size: 0.95em;
        }

        .selected-info p {
            color: #cccccc;
            margin: 4px 0;
            font-size: 0.85em;
        }

        /* Hide pyvis default elements */
        center, h1:empty {
            display: none !important;
        }

        .card {
            border: none !important;
            background: transparent !important;
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1a1a2e;
        }

        ::-webkit-scrollbar-thumb {
            background: #4a4a6a;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #5a5a7a;
        }
    </style>
    </head>


    <body>
    <div class="app-container">
        <!-- Left Panel: Controls -->
        <div class="left-panel">
            <div class="panel-header">
                <h1 class="app-title">üìä Requirements Dependency Graph</h1>
                <p class="app-subtitle">Grafo interactivo de dependencias</p>
            </div>

            <div class="controls-section">
                <h3>üîç Buscar Nodo</h3>
                <div class="control-row">
                    <label>ID del Requisito:</label>
                    <input type="text" id="node-search" placeholder="Ej: RM-001, RM-015">
                </div>
                <button class="btn" id="btn-search">Buscar y Enfocar</button>
            </div>

            <div class="controls-section">
                <h3>üéõÔ∏è Filtros</h3>
                <div class="control-row">
                    <label>√Årea:</label>
                    <select id="area-filter">
                        <option value="">‚Äî Todas las √°reas ‚Äî</option>
                        <option value="Auditabilidad">Auditabilidad</option><option value="Calidad de datos">Calidad de datos</option><option value="Dashboard">Dashboard</option><option value="DevOps">DevOps</option><option value="Documentaci√≥n">Documentaci√≥n</option><option value="Entregables">Entregables</option><option value="Exportaci√≥n">Exportaci√≥n</option><option value="Extensibilidad">Extensibilidad</option><option value="Extracci√≥n">Extracci√≥n</option><option value="Gobernanza">Gobernanza</option><option value="Gobernanza de datos">Gobernanza de datos</option><option value="Ingesta">Ingesta</option><option value="Modelo de datos">Modelo de datos</option><option value="M√©tricas">M√©tricas</option><option value="Observabilidad">Observabilidad</option><option value="Performance">Performance</option><option value="Privacidad">Privacidad</option><option value="Reportes">Reportes</option><option value="Reproducibilidad">Reproducibilidad</option><option value="Seguridad">Seguridad</option><option value="Testing">Testing</option><option value="Transformaci√≥n">Transformaci√≥n</option><option value="UX">UX</option><option value="Validaci√≥n de algoritmo">Validaci√≥n de algoritmo</option>
                    </select>
                </div>
                <div class="control-row">
                    <label>Prioridad:</label>
                    <select id="priority-filter">
                        <option value="">‚Äî Todas las prioridades ‚Äî</option>
                        <option value="Alta (P0)">Alta (P0)</option><option value="Media (P1)">Media (P1)</option><option value="Baja (P2)">Baja (P2)</option>
                    </select>
                </div>
                <div class="control-row">
                    <label>Versi√≥n:</label>
                    <select id="version-filter">
                        <option value="">‚Äî Todas las versiones ‚Äî</option>
                        <option value="MVP v0.1">MVP v0.1</option><option value="v0.2">v0.2</option><option value="v0.3">v0.3</option>
                    </select>
                </div>
            </div>

            <div class="controls-section">
                <h3>üîó Explorar Conexiones</h3>
                <p style="color: #8888aa; font-size: 0.8em; margin: 0 0 10px 0;">Primero selecciona un nodo en el grafo</p>
                <div class="btn-group">
                    <button class="btn btn-secondary" id="btn-ancestors">‚Üê Dependencias</button>
                    <button class="btn btn-secondary" id="btn-descendants">Dependientes ‚Üí</button>
                </div>
                <button class="btn btn-secondary" id="btn-neighborhood" style="margin-top: 8px;">Vecindario Completo</button>
            </div>

            <div class="controls-section">
                <h3>üìê Disposici√≥n</h3>
                <div class="layout-toggle">
                    <button class="layout-btn active" id="layout-force">Fuerza</button>
                    <button class="layout-btn" id="layout-tree">√Årbol</button>
                </div>
            </div>

            <div class="controls-section">
                <button class="btn btn-secondary" id="btn-reset">üîÑ Restablecer Vista</button>
            </div>

            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-label">Nodos Visibles</div>
                    <div class="stat-value" id="visible-nodes">50</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Conexiones</div>
                    <div class="stat-value" id="visible-edges">141</div>
                </div>
            </div>

            <div class="panel-header">
                <h2>üé® Leyenda de √Åreas</h2>
            </div>
            <div class="legend-container">
                <div class="legend-item" data-area="Auditabilidad"><div class="legend-color" style="background: #F9E79F"></div><span>Auditabilidad</span></div><div class="legend-item" data-area="Calidad de datos"><div class="legend-color" style="background: #82E0AA"></div><span>Calidad de datos</span></div><div class="legend-item" data-area="Dashboard"><div class="legend-color" style="background: #85C1E9"></div><span>Dashboard</span></div><div class="legend-item" data-area="DevOps"><div class="legend-color" style="background: #AED6F1"></div><span>DevOps</span></div><div class="legend-item" data-area="Documentaci√≥n"><div class="legend-color" style="background: #D5DBDB"></div><span>Documentaci√≥n</span></div><div class="legend-item" data-area="Entregables"><div class="legend-color" style="background: #FAD7A0"></div><span>Entregables</span></div><div class="legend-item" data-area="Exportaci√≥n"><div class="legend-color" style="background: #D2B4DE"></div><span>Exportaci√≥n</span></div><div class="legend-item" data-area="Extensibilidad"><div class="legend-color" style="background: #A9DFBF"></div><span>Extensibilidad</span></div><div class="legend-item" data-area="Extracci√≥n"><div class="legend-color" style="background: #FF6B6B"></div><span>Extracci√≥n</span></div><div class="legend-item" data-area="Gobernanza"><div class="legend-color" style="background: #D7BDE2"></div><span>Gobernanza</span></div><div class="legend-item" data-area="Gobernanza de datos"><div class="legend-color" style="background: #D7BDE2"></div><span>Gobernanza de datos</span></div><div class="legend-item" data-area="Ingesta"><div class="legend-color" style="background: #4ECDC4"></div><span>Ingesta</span></div><div class="legend-item" data-area="Modelo de datos"><div class="legend-color" style="background: #45B7D1"></div><span>Modelo de datos</span></div><div class="legend-item" data-area="M√©tricas"><div class="legend-color" style="background: #FFD93D"></div><span>M√©tricas</span></div><div class="legend-item" data-area="Observabilidad"><div class="legend-color" style="background: #ABEBC6"></div><span>Observabilidad</span></div><div class="legend-item" data-area="Performance"><div class="legend-color" style="background: #F5CBA7"></div><span>Performance</span></div><div class="legend-item" data-area="Privacidad"><div class="legend-color" style="background: #FADBD8"></div><span>Privacidad</span></div><div class="legend-item" data-area="Reportes"><div class="legend-color" style="background: #BB8FCE"></div><span>Reportes</span></div><div class="legend-item" data-area="Reproducibilidad"><div class="legend-color" style="background: #AEB6BF"></div><span>Reproducibilidad</span></div><div class="legend-item" data-area="Seguridad"><div class="legend-color" style="background: #F1948A"></div><span>Seguridad</span></div><div class="legend-item" data-area="Testing"><div class="legend-color" style="background: #F5B041"></div><span>Testing</span></div><div class="legend-item" data-area="Transformaci√≥n"><div class="legend-color" style="background: #96CEB4"></div><span>Transformaci√≥n</span></div><div class="legend-item" data-area="UX"><div class="legend-color" style="background: #85C1E9"></div><span>UX</span></div><div class="legend-item" data-area="Validaci√≥n de algoritmo"><div class="legend-color" style="background: #76D7C4"></div><span>Validaci√≥n de algoritmo</span></div>
            </div>
        </div>

        <!-- Center: Graph -->
        <div class="graph-panel">
            <div id="mynetwork"></div>
        </div>

        <!-- Right Panel: Data Table -->
        <div class="right-panel">
            <div class="selected-info" id="selected-info">
                <h3 id="selected-title">Nodo Seleccionado</h3>
                <p><strong>ID:</strong> <span id="sel-id">‚Äî</span></p>
                <p><strong>√Årea:</strong> <span id="sel-area">‚Äî</span></p>
                <p><strong>Prioridad:</strong> <span id="sel-priority">‚Äî</span></p>
                <p><strong>Dependencias:</strong> <span id="sel-deps">‚Äî</span></p>
            </div>
            <div class="table-header">
                <h2>üìã Requisitos Visibles</h2>
                <span class="table-count" id="table-count">50 requisitos</span>
            </div>
            <div class="table-container">
                <table class="data-table" id="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>√Årea</th>
                            <th>Funcionalidad</th>
                            <th>Prioridad</th>
                            <th>Versi√≥n</th>
                        </tr>
                    </thead>
                    <tbody id="table-body">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="hover-tooltip"></div>
    <script type="text/javascript">

              // initialize global variables.
              var edges;
              var nodes;
              var allNodes;
              var allEdges;
              var nodeColors;
              var originalNodes;
              var network;
              var container;
              var options, data;
              var filter = {
                  item : '',
                  property : '',
                  value : []
              };

              

              

              // This method is responsible for drawing the graph, returns the drawn network
              function drawGraph() {
                  var container = document.getElementById('mynetwork');

                  

                  // parsing and collecting nodes and edges from the python
                  nodes = new vis.DataSet([{"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Ingesta", "id": "RM-001", "label": "RM-001", "level": 0, "shape": "dot", "size": 35, "title": "RM-001: Registro de brokers"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Ingesta", "id": "RM-002", "label": "RM-002", "level": 1, "shape": "dot", "size": 35, "title": "RM-002: Validaci\u00f3n de URL"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Ingesta", "id": "RM-003", "label": "RM-003", "level": 2, "shape": "dot", "size": 25, "title": "RM-003: Pol\u00edticas de acceso por dominio (robots/ToS)"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Ingesta", "id": "RM-004", "label": "RM-004", "level": 1, "shape": "dot", "size": 35, "title": "RM-004: Scheduler de crawls"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Ingesta", "id": "RM-005", "label": "RM-005", "level": 1, "shape": "dot", "size": 35, "title": "RM-005: Rate limiting, retries y circuit breaker"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Extracci\u00f3n", "id": "RM-006", "label": "RM-006", "level": 2, "shape": "dot", "size": 35, "title": "RM-006: Parser HTML por dominio"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Extracci\u00f3n", "id": "RM-007", "label": "RM-007", "level": 1, "shape": "dot", "size": 25, "title": "RM-007: Soporte JSON/API cuando exista"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Extracci\u00f3n", "id": "RM-008", "label": "RM-008", "level": 2, "shape": "dot", "size": 18, "title": "RM-008: Descarga de adjuntos relevantes"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Modelo de datos", "id": "RM-009", "label": "RM-009", "level": 1, "shape": "dot", "size": 35, "title": "RM-009: Almacenamiento de datos crudos versionados"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Modelo de datos", "id": "RM-010", "label": "RM-010", "level": 1, "shape": "dot", "size": 35, "title": "RM-010: Entidades normalizadas y snapshots"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Transformaci\u00f3n", "id": "RM-011", "label": "RM-011", "level": 1, "shape": "dot", "size": 35, "title": "RM-011: Reglas de mapeo configurables"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Transformaci\u00f3n", "id": "RM-012", "label": "RM-012", "level": 1, "shape": "dot", "size": 35, "title": "RM-012: Limpieza y estandarizaci\u00f3n de datos"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "M\u00e9tricas", "id": "RM-013", "label": "RM-013", "level": 1, "shape": "dot", "size": 35, "title": "RM-013: Cat\u00e1logo de definiciones de m\u00e9tricas"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "M\u00e9tricas", "id": "RM-014", "label": "RM-014", "level": 1, "shape": "dot", "size": 35, "title": "RM-014: C\u00e1lculo de m\u00e9tricas core"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "M\u00e9tricas", "id": "RM-015", "label": "RM-015", "level": 1, "shape": "dot", "size": 25, "title": "RM-015: M\u00e9tricas de costos/fees"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "M\u00e9tricas", "id": "RM-016", "label": "RM-016", "level": 2, "shape": "dot", "size": 18, "title": "RM-016: Flags de riesgo/compliance basados en reglas"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "M\u00e9tricas", "id": "RM-017", "label": "RM-017", "level": 1, "shape": "dot", "size": 35, "title": "RM-017: Benchmarks, percentiles y rankings"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Calidad de datos", "id": "RM-018", "label": "RM-018", "level": 2, "shape": "dot", "size": 35, "title": "RM-018: Score de completitud"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Calidad de datos", "id": "RM-019", "label": "RM-019", "level": 3, "shape": "dot", "size": 25, "title": "RM-019: Detecci\u00f3n de anomal\u00edas"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Auditabilidad", "id": "RM-020", "label": "RM-020", "level": 2, "shape": "dot", "size": 35, "title": "RM-020: Lineage de m\u00e9tricas a raw data"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Validaci\u00f3n de algoritmo", "id": "RM-021", "label": "RM-021", "level": 1, "shape": "dot", "size": 35, "title": "RM-021: Contrato de integraci\u00f3n del algoritmo"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Validaci\u00f3n de algoritmo", "id": "RM-022", "label": "RM-022", "level": 1, "shape": "dot", "size": 35, "title": "RM-022: Constructor de datasets (feature matrix)"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Validaci\u00f3n de algoritmo", "id": "RM-023", "label": "RM-023", "level": 2, "shape": "dot", "size": 35, "title": "RM-023: Runner de backtests/experimentos"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Validaci\u00f3n de algoritmo", "id": "RM-024", "label": "RM-024", "level": 2, "shape": "dot", "size": 35, "title": "RM-024: M\u00e9tricas de evaluaci\u00f3n y scorecards"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Validaci\u00f3n de algoritmo", "id": "RM-025", "label": "RM-025", "level": 2, "shape": "dot", "size": 25, "title": "RM-025: Diagn\u00f3sticos y sensibilidad"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Validaci\u00f3n de algoritmo", "id": "RM-026", "label": "RM-026", "level": 1, "shape": "dot", "size": 25, "title": "RM-026: What-if y parameter sweeps"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Reportes", "id": "RM-027", "label": "RM-027", "level": 3, "shape": "dot", "size": 35, "title": "RM-027: Plantillas y generaci\u00f3n de reportes"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Reportes", "id": "RM-028", "label": "RM-028", "level": 3, "shape": "dot", "size": 18, "title": "RM-028: Distribuci\u00f3n programada"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Dashboard", "id": "RM-029", "label": "RM-029", "level": 5, "shape": "dot", "size": 35, "title": "RM-029: Vistas core del dashboard"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Dashboard", "id": "RM-030", "label": "RM-030", "level": 4, "shape": "dot", "size": 35, "title": "RM-030: Comparaciones y rankings"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Dashboard", "id": "RM-031", "label": "RM-031", "level": 3, "shape": "dot", "size": 25, "title": "RM-031: Explorador de runs/experimentos"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Exportaci\u00f3n", "id": "RM-032", "label": "RM-032", "level": 3, "shape": "dot", "size": 35, "title": "RM-032: Exports de datos y resultados"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Seguridad", "id": "RM-033", "label": "RM-033", "level": 0, "shape": "dot", "size": 35, "title": "RM-033: Autenticaci\u00f3n"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Seguridad", "id": "RM-034", "label": "RM-034", "level": 1, "shape": "dot", "size": 35, "title": "RM-034: Autorizaci\u00f3n y roles (RBAC)"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Seguridad", "id": "RM-035", "label": "RM-035", "level": 1, "shape": "dot", "size": 35, "title": "RM-035: Gesti\u00f3n de secretos"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Observabilidad", "id": "RM-036", "label": "RM-036", "level": 2, "shape": "dot", "size": 35, "title": "RM-036: Logging estructurado con correlaci\u00f3n"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Observabilidad", "id": "RM-037", "label": "RM-037", "level": 1, "shape": "dot", "size": 25, "title": "RM-037: M\u00e9tricas y alertas operativas"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Performance", "id": "RM-038", "label": "RM-038", "level": 2, "shape": "dot", "size": 35, "title": "RM-038: Throughput del pipeline"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Performance", "id": "RM-039", "label": "RM-039", "level": 2, "shape": "dot", "size": 25, "title": "RM-039: Responsividad del dashboard"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Reproducibilidad", "id": "RM-040", "label": "RM-040", "level": 5, "shape": "dot", "size": 35, "title": "RM-040: Versionado end-to-end de componentes"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Testing", "id": "RM-041", "label": "RM-041", "level": 3, "shape": "dot", "size": 35, "title": "RM-041: Suite de unit/integration/E2E"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Testing", "id": "RM-042", "label": "RM-042", "level": 3, "shape": "dot", "size": 35, "title": "RM-042: Data contract tests (schemas)"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "DevOps", "id": "RM-043", "label": "RM-043", "level": 2, "shape": "dot", "size": 35, "title": "RM-043: CI/CD + migraciones + rollback"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Gobernanza de datos", "id": "RM-044", "label": "RM-044", "level": 3, "shape": "dot", "size": 25, "title": "RM-044: Retenci\u00f3n y archivado"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Gobernanza", "id": "RM-045", "label": "RM-045", "level": 1, "shape": "dot", "size": 35, "title": "RM-045: Bit\u00e1cora de auditor\u00eda de acciones cr\u00edticas"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "UX", "id": "RM-046", "label": "RM-046", "level": 3, "shape": "dot", "size": 25, "title": "RM-046: Transparencia de errores y remediaci\u00f3n"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Privacidad", "id": "RM-047", "label": "RM-047", "level": 2, "shape": "dot", "size": 18, "title": "RM-047: Minimizaci\u00f3n y redacci\u00f3n de datos"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Documentaci\u00f3n", "id": "RM-048", "label": "RM-048", "level": 1, "shape": "dot", "size": 35, "title": "RM-048: Docs t\u00e9cnicas y operativas"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Extensibilidad", "id": "RM-049", "label": "RM-049", "level": 3, "shape": "dot", "size": 25, "title": "RM-049: Onboarding de nuevo dominio/fuente"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Entregables", "id": "RM-050", "label": "RM-050", "level": 49, "shape": "dot", "size": 35, "title": "RM-050: Criterio de aceptaci\u00f3n del MVP"}]);
                  edges = new vis.DataSet([{"arrows": "to", "from": "RM-001", "to": "RM-002"}, {"arrows": "to", "from": "RM-001", "to": "RM-003"}, {"arrows": "to", "from": "RM-001", "to": "RM-004"}, {"arrows": "to", "from": "RM-001", "to": "RM-050"}, {"arrows": "to", "from": "RM-002", "to": "RM-003"}, {"arrows": "to", "from": "RM-002", "to": "RM-050"}, {"arrows": "to", "from": "RM-003", "to": "RM-005"}, {"arrows": "to", "from": "RM-003", "to": "RM-008"}, {"arrows": "to", "from": "RM-003", "to": "RM-050"}, {"arrows": "to", "from": "RM-004", "to": "RM-006"}, {"arrows": "to", "from": "RM-004", "to": "RM-028"}, {"arrows": "to", "from": "RM-004", "to": "RM-036"}, {"arrows": "to", "from": "RM-004", "to": "RM-038"}, {"arrows": "to", "from": "RM-004", "to": "RM-050"}, {"arrows": "to", "from": "RM-005", "to": "RM-006"}, {"arrows": "to", "from": "RM-005", "to": "RM-038"}, {"arrows": "to", "from": "RM-005", "to": "RM-050"}, {"arrows": "to", "from": "RM-006", "to": "RM-007"}, {"arrows": "to", "from": "RM-006", "to": "RM-008"}, {"arrows": "to", "from": "RM-006", "to": "RM-009"}, {"arrows": "to", "from": "RM-006", "to": "RM-041"}, {"arrows": "to", "from": "RM-006", "to": "RM-049"}, {"arrows": "to", "from": "RM-006", "to": "RM-050"}, {"arrows": "to", "from": "RM-007", "to": "RM-050"}, {"arrows": "to", "from": "RM-008", "to": "RM-050"}, {"arrows": "to", "from": "RM-009", "to": "RM-010"}, {"arrows": "to", "from": "RM-009", "to": "RM-019"}, {"arrows": "to", "from": "RM-009", "to": "RM-020"}, {"arrows": "to", "from": "RM-009", "to": "RM-040"}, {"arrows": "to", "from": "RM-009", "to": "RM-044"}, {"arrows": "to", "from": "RM-009", "to": "RM-050"}, {"arrows": "to", "from": "RM-010", "to": "RM-011"}, {"arrows": "to", "from": "RM-010", "to": "RM-013"}, {"arrows": "to", "from": "RM-010", "to": "RM-022"}, {"arrows": "to", "from": "RM-010", "to": "RM-032"}, {"arrows": "to", "from": "RM-010", "to": "RM-042"}, {"arrows": "to", "from": "RM-010", "to": "RM-050"}, {"arrows": "to", "from": "RM-011", "to": "RM-012"}, {"arrows": "to", "from": "RM-011", "to": "RM-019"}, {"arrows": "to", "from": "RM-011", "to": "RM-040"}, {"arrows": "to", "from": "RM-011", "to": "RM-049"}, {"arrows": "to", "from": "RM-011", "to": "RM-050"}, {"arrows": "to", "from": "RM-012", "to": "RM-050"}, {"arrows": "to", "from": "RM-013", "to": "RM-014"}, {"arrows": "to", "from": "RM-013", "to": "RM-015"}, {"arrows": "to", "from": "RM-013", "to": "RM-016"}, {"arrows": "to", "from": "RM-013", "to": "RM-018"}, {"arrows": "to", "from": "RM-013", "to": "RM-020"}, {"arrows": "to", "from": "RM-013", "to": "RM-024"}, {"arrows": "to", "from": "RM-013", "to": "RM-032"}, {"arrows": "to", "from": "RM-013", "to": "RM-040"}, {"arrows": "to", "from": "RM-013", "to": "RM-041"}, {"arrows": "to", "from": "RM-013", "to": "RM-050"}, {"arrows": "to", "from": "RM-014", "to": "RM-017"}, {"arrows": "to", "from": "RM-014", "to": "RM-018"}, {"arrows": "to", "from": "RM-014", "to": "RM-019"}, {"arrows": "to", "from": "RM-014", "to": "RM-027"}, {"arrows": "to", "from": "RM-014", "to": "RM-029"}, {"arrows": "to", "from": "RM-014", "to": "RM-050"}, {"arrows": "to", "from": "RM-015", "to": "RM-050"}, {"arrows": "to", "from": "RM-016", "to": "RM-050"}, {"arrows": "to", "from": "RM-017", "to": "RM-029"}, {"arrows": "to", "from": "RM-017", "to": "RM-030"}, {"arrows": "to", "from": "RM-017", "to": "RM-039"}, {"arrows": "to", "from": "RM-017", "to": "RM-050"}, {"arrows": "to", "from": "RM-018", "to": "RM-030"}, {"arrows": "to", "from": "RM-018", "to": "RM-050"}, {"arrows": "to", "from": "RM-019", "to": "RM-030"}, {"arrows": "to", "from": "RM-019", "to": "RM-046"}, {"arrows": "to", "from": "RM-019", "to": "RM-050"}, {"arrows": "to", "from": "RM-020", "to": "RM-016"}, {"arrows": "to", "from": "RM-020", "to": "RM-027"}, {"arrows": "to", "from": "RM-020", "to": "RM-029"}, {"arrows": "to", "from": "RM-020", "to": "RM-046"}, {"arrows": "to", "from": "RM-020", "to": "RM-050"}, {"arrows": "to", "from": "RM-021", "to": "RM-023"}, {"arrows": "to", "from": "RM-021", "to": "RM-040"}, {"arrows": "to", "from": "RM-021", "to": "RM-042"}, {"arrows": "to", "from": "RM-021", "to": "RM-050"}, {"arrows": "to", "from": "RM-022", "to": "RM-021"}, {"arrows": "to", "from": "RM-022", "to": "RM-023"}, {"arrows": "to", "from": "RM-022", "to": "RM-040"}, {"arrows": "to", "from": "RM-022", "to": "RM-042"}, {"arrows": "to", "from": "RM-022", "to": "RM-050"}, {"arrows": "to", "from": "RM-023", "to": "RM-024"}, {"arrows": "to", "from": "RM-023", "to": "RM-025"}, {"arrows": "to", "from": "RM-023", "to": "RM-026"}, {"arrows": "to", "from": "RM-023", "to": "RM-031"}, {"arrows": "to", "from": "RM-023", "to": "RM-036"}, {"arrows": "to", "from": "RM-023", "to": "RM-041"}, {"arrows": "to", "from": "RM-023", "to": "RM-044"}, {"arrows": "to", "from": "RM-023", "to": "RM-050"}, {"arrows": "to", "from": "RM-024", "to": "RM-025"}, {"arrows": "to", "from": "RM-024", "to": "RM-027"}, {"arrows": "to", "from": "RM-024", "to": "RM-031"}, {"arrows": "to", "from": "RM-024", "to": "RM-050"}, {"arrows": "to", "from": "RM-025", "to": "RM-050"}, {"arrows": "to", "from": "RM-026", "to": "RM-050"}, {"arrows": "to", "from": "RM-027", "to": "RM-028"}, {"arrows": "to", "from": "RM-027", "to": "RM-044"}, {"arrows": "to", "from": "RM-027", "to": "RM-050"}, {"arrows": "to", "from": "RM-028", "to": "RM-050"}, {"arrows": "to", "from": "RM-029", "to": "RM-039"}, {"arrows": "to", "from": "RM-029", "to": "RM-050"}, {"arrows": "to", "from": "RM-030", "to": "RM-050"}, {"arrows": "to", "from": "RM-031", "to": "RM-050"}, {"arrows": "to", "from": "RM-032", "to": "RM-030"}, {"arrows": "to", "from": "RM-032", "to": "RM-047"}, {"arrows": "to", "from": "RM-032", "to": "RM-050"}, {"arrows": "to", "from": "RM-033", "to": "RM-029"}, {"arrows": "to", "from": "RM-033", "to": "RM-034"}, {"arrows": "to", "from": "RM-033", "to": "RM-050"}, {"arrows": "to", "from": "RM-034", "to": "RM-028"}, {"arrows": "to", "from": "RM-034", "to": "RM-029"}, {"arrows": "to", "from": "RM-034", "to": "RM-031"}, {"arrows": "to", "from": "RM-034", "to": "RM-032"}, {"arrows": "to", "from": "RM-034", "to": "RM-045"}, {"arrows": "to", "from": "RM-034", "to": "RM-050"}, {"arrows": "to", "from": "RM-035", "to": "RM-043"}, {"arrows": "to", "from": "RM-035", "to": "RM-050"}, {"arrows": "to", "from": "RM-036", "to": "RM-037"}, {"arrows": "to", "from": "RM-036", "to": "RM-046"}, {"arrows": "to", "from": "RM-036", "to": "RM-047"}, {"arrows": "to", "from": "RM-036", "to": "RM-050"}, {"arrows": "to", "from": "RM-037", "to": "RM-050"}, {"arrows": "to", "from": "RM-038", "to": "RM-050"}, {"arrows": "to", "from": "RM-039", "to": "RM-050"}, {"arrows": "to", "from": "RM-040", "to": "RM-050"}, {"arrows": "to", "from": "RM-041", "to": "RM-043"}, {"arrows": "to", "from": "RM-041", "to": "RM-049"}, {"arrows": "to", "from": "RM-041", "to": "RM-050"}, {"arrows": "to", "from": "RM-042", "to": "RM-050"}, {"arrows": "to", "from": "RM-043", "to": "RM-035"}, {"arrows": "to", "from": "RM-043", "to": "RM-048"}, {"arrows": "to", "from": "RM-043", "to": "RM-050"}, {"arrows": "to", "from": "RM-044", "to": "RM-050"}, {"arrows": "to", "from": "RM-045", "to": "RM-050"}, {"arrows": "to", "from": "RM-046", "to": "RM-050"}, {"arrows": "to", "from": "RM-047", "to": "RM-050"}, {"arrows": "to", "from": "RM-048", "to": "RM-050"}, {"arrows": "to", "from": "RM-049", "to": "RM-050"}]);

                  nodeColors = {};
                  allNodes = nodes.get({ returnType: "Object" });
                  for (nodeId in allNodes) {
                    nodeColors[nodeId] = allNodes[nodeId].color;
                  }
                  allEdges = edges.get({ returnType: "Object" });
                  // adding nodes and edges to the graph
                  data = {nodes: nodes, edges: edges};

                  var options = {"nodes": {"font": {"size": 14, "face": "arial", "strokeWidth": 3, "strokeColor": "#1a1a2e"}, "borderWidth": 2, "borderWidthSelected": 4, "shadow": {"enabled": true, "color": "rgba(0,0,0,0.5)", "size": 10, "x": 3, "y": 3}}, "edges": {"color": {"color": "#4a4a6a", "highlight": "#00ff88", "hover": "#00ff88"}, "arrows": {"to": {"enabled": true, "scaleFactor": 0.8}}, "smooth": {"enabled": true, "type": "curvedCW", "roundness": 0.2}, "width": 1.5, "selectionWidth": 3}, "physics": {"enabled": true, "solver": "forceAtlas2Based", "forceAtlas2Based": {"gravitationalConstant": -80, "centralGravity": 0.01, "springLength": 150, "springConstant": 0.08, "damping": 0.4, "avoidOverlap": 0.8}, "stabilization": {"enabled": true, "iterations": 200, "updateInterval": 25}}, "interaction": {"hover": true, "hoverConnectedEdges": true, "selectConnectedEdges": true, "multiselect": true, "dragNodes": true, "dragView": true, "zoomView": true, "navigationButtons": true, "keyboard": {"enabled": true, "speed": {"x": 10, "y": 10, "zoom": 0.1}}, "tooltipDelay": 100}, "configure": {"enabled": false}};

                  


                  

                  network = new vis.Network(container, data, options);

                  

                  

                  


                  

                  return network;

              }
              drawGraph();
        </script>
    
    <script>
    (function() {
        // Data
        const nodeData = {"RM-001": {"area": "Ingesta", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Registro de brokers", "requisito": "El sistema deber√° permitir cargar y administrar una lista configurable de N brokers con 1..N URLs de perfil por broker y metadatos (broker_id, nombre, regi√≥n, etiquetas/estrategia). Debe soportar importaci√≥n masiva (CSV) y edici√≥n incremental.", "owner": "Backend", "roles": "Admin; Sistema", "estatus": "BACKLOG", "dependencias": "‚Äî", "in_degree": 0, "out_degree": 4}, "RM-002": {"area": "Ingesta", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Validaci√≥n de URL", "requisito": "Antes de ejecutar extracci√≥n, el sistema deber√° validar cada URL (sintaxis, esquema, dominio permitido, alcanzabilidad HTTP/DNS) y persistir el resultado con c√≥digo de error y pol√≠tica de reintento.", "owner": "Backend", "roles": "Sistema; Admin", "estatus": "BACKLOG", "dependencias": "RM-001", "in_degree": 1, "out_degree": 2}, "RM-003": {"area": "Ingesta", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Pol√≠ticas de acceso por dominio (robots/ToS)", "requisito": "El sistema deber√° registrar pol√≠ticas por dominio (robots.txt snapshot, rate limit, notas ToS internas) y hacer cumplir dichas pol√≠ticas durante la extracci√≥n. Debe permitir bloquear dominios o pausar scraping.", "owner": "Backend/DevOps", "roles": "Admin; DevOps; Sistema", "estatus": "BACKLOG", "dependencias": "RM-001,RM-002", "in_degree": 2, "out_degree": 3}, "RM-004": {"area": "Ingesta", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Scheduler de crawls", "requisito": "El sistema deber√° soportar ejecuci√≥n programada (horario configurable por proyecto y/o por broker) y refresh on-demand por broker, generando jobs con trazabilidad (run_id, broker_id, created_by).", "owner": "Backend/DevOps", "roles": "Admin; Analista; Sistema", "estatus": "BACKLOG", "dependencias": "RM-001", "in_degree": 1, "out_degree": 5}, "RM-005": {"area": "Ingesta", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Rate limiting, retries y circuit breaker", "requisito": "El sistema deber√° implementar rate limiting por dominio, retries con exponential backoff y circuit breaker ante fallas repetidas. Debe registrar m√©tricas de requests y errores.", "owner": "Backend/DevOps", "roles": "Sistema; DevOps", "estatus": "BACKLOG", "dependencias": "RM-003", "in_degree": 1, "out_degree": 3}, "RM-006": {"area": "Extracci√≥n", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Parser HTML por dominio", "requisito": "El sistema deber√° extraer datos crudos desde HTML usando adaptadores por dominio (selectores/mapeos) mantenibles y testeables, versionando el parser.", "owner": "Backend", "roles": "Sistema; Backend", "estatus": "BACKLOG", "dependencias": "RM-004,RM-005", "in_degree": 2, "out_degree": 6}, "RM-007": {"area": "Extracci√≥n", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Soporte JSON/API cuando exista", "requisito": "Si el perfil expone datos v√≠a JSON/API (directo o embebido), el adaptador deber√° preferir esa fuente por estabilidad y registrar el endpoint utilizado.", "owner": "Backend", "roles": "Sistema; Backend", "estatus": "BACKLOG", "dependencias": "RM-006", "in_degree": 1, "out_degree": 1}, "RM-008": {"area": "Extracci√≥n", "prioridad": "Baja (P2)", "version": "v0.3", "funcionalidad": "Descarga de adjuntos relevantes", "requisito": "El sistema deber√° detectar y descargar adjuntos/links (PDF u otros permitidos) asociados al perfil cuando est√©n presentes y permitidos por pol√≠tica, guardando checksum y metadatos.", "owner": "Backend", "roles": "Sistema; Backend", "estatus": "BACKLOG", "dependencias": "RM-003,RM-006", "in_degree": 2, "out_degree": 1}, "RM-009": {"area": "Modelo de datos", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Almacenamiento de datos crudos versionados", "requisito": "El sistema deber√° guardar registros crudos inmutables con URL fuente, timestamp, parser_version, content_hash y payload (JSON). No debe sobrescribir datos crudos.", "owner": "Backend", "roles": "Sistema; Backend", "estatus": "BACKLOG", "dependencias": "RM-006", "in_degree": 1, "out_degree": 6}, "RM-010": {"area": "Modelo de datos", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Entidades normalizadas y snapshots", "requisito": "El sistema deber√° normalizar datos crudos a entidades n√∫cleo (Broker, ProfileSnapshot, MetricDefinition, MetricValue, Run, Experiment) y soportar snapshots temporalmente indexados.", "owner": "Backend", "roles": "Backend; Quant; Sistema", "estatus": "BACKLOG", "dependencias": "RM-009", "in_degree": 1, "out_degree": 6}, "RM-011": {"area": "Transformaci√≥n", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Reglas de mapeo configurables", "requisito": "El sistema deber√° permitir definir reglas de mapeo (por dominio) desde campos crudos a campos normalizados, con versionado y capacidad de rollback. Idealmente sin despliegue de c√≥digo para cambios menores.", "owner": "Backend", "roles": "Admin; Backend; Quant", "estatus": "BACKLOG", "dependencias": "RM-010", "in_degree": 1, "out_degree": 5}, "RM-012": {"area": "Transformaci√≥n", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Limpieza y estandarizaci√≥n de datos", "requisito": "El sistema deber√° limpiar y estandarizar formatos (fechas, divisas, porcentajes, locales) a formatos can√≥nicos y registrar errores de parseo por campo.", "owner": "Backend", "roles": "Backend; Sistema", "estatus": "BACKLOG", "dependencias": "RM-011", "in_degree": 1, "out_degree": 1}, "RM-013": {"area": "M√©tricas", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Cat√°logo de definiciones de m√©tricas", "requisito": "El sistema deber√° mantener un registro versionado de m√©tricas (nombre, f√≥rmula/algoritmo, insumos requeridos, unidad, rango v√°lido, y constraints). Ser√° la fuente √∫nica para c√≥mputo y reporteo.", "owner": "Backend/Quant", "roles": "Quant; Backend; Admin", "estatus": "BACKLOG", "dependencias": "RM-010", "in_degree": 1, "out_degree": 10}, "RM-014": {"area": "M√©tricas", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "C√°lculo de m√©tricas core", "requisito": "El sistema deber√° calcular m√©tricas base por broker y por periodo (p.ej. rendimiento, volatilidad, drawdown, win-rate) a partir de los datos disponibles, y manejar expl√≠citamente el caso de 'datos insuficientes'.", "owner": "Quant", "roles": "Quant; Sistema", "estatus": "BACKLOG", "dependencias": "RM-013", "in_degree": 1, "out_degree": 6}, "RM-015": {"area": "M√©tricas", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "M√©tricas de costos/fees", "requisito": "El sistema deber√° calcular m√©tricas relacionadas a costos/fees/spread cuando existan, documentando supuestos y anex√°ndolos a reportes y exportaciones.", "owner": "Quant", "roles": "Quant; Analista", "estatus": "BACKLOG", "dependencias": "RM-013", "in_degree": 1, "out_degree": 1}, "RM-016": {"area": "M√©tricas", "prioridad": "Baja (P2)", "version": "v0.3", "funcionalidad": "Flags de riesgo/compliance basados en reglas", "requisito": "El sistema deber√° evaluar reglas determin√≠sticas para generar banderas (p.ej. disclosures faltantes, claims an√≥malos) y adjuntar evidencia (campo crudo + snapshot) para cada flag.", "owner": "Quant/Backend", "roles": "Quant; Analista; Admin", "estatus": "BACKLOG", "dependencias": "RM-013,RM-020", "in_degree": 2, "out_degree": 1}, "RM-017": {"area": "M√©tricas", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Benchmarks, percentiles y rankings", "requisito": "El sistema deber√° generar agregados cross-broker (percentiles, rankings, peer groups) con definiciones versionadas de peer group y desempate determin√≠stico.", "owner": "Quant", "roles": "Analista; Viewer", "estatus": "BACKLOG", "dependencias": "RM-014", "in_degree": 1, "out_degree": 4}, "RM-018": {"area": "Calidad de datos", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Score de completitud", "requisito": "El sistema deber√° calcular un score de completitud por broker y por m√©trica en [0,1], basado en disponibilidad de insumos y cobertura temporal. Debe mostrarse en dashboard y reportes.", "owner": "Backend/Quant", "roles": "Analista; Viewer", "estatus": "BACKLOG", "dependencias": "RM-013,RM-014", "in_degree": 2, "out_degree": 2}, "RM-019": {"area": "Calidad de datos", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Detecci√≥n de anomal√≠as", "requisito": "El sistema deber√° detectar anomal√≠as (saltos bruscos de m√©tricas, huecos temporales, cambios de parser/mapping) y etiquetar resultados afectados; debe permitir filtrar anomal√≠as en validaci√≥n del algoritmo.", "owner": "Quant/Backend", "roles": "Analista; Quant; DevOps", "estatus": "BACKLOG", "dependencias": "RM-014,RM-011,RM-009", "in_degree": 3, "out_degree": 3}, "RM-020": {"area": "Auditabilidad", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Lineage de m√©tricas a raw data", "requisito": "El sistema deber√° proveer trazabilidad desde cualquier valor de m√©trica/ranking/reporte hasta los raw_records y transformaciones usadas (parser_version, mapping_version, metric_definition_version).", "owner": "Backend", "roles": "Analista; Admin", "estatus": "BACKLOG", "dependencias": "RM-009,RM-013", "in_degree": 2, "out_degree": 5}, "RM-021": {"area": "Validaci√≥n de algoritmo", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Contrato de integraci√≥n del algoritmo", "requisito": "El sistema deber√° integrar el algoritmo de optimizaci√≥n del cliente mediante una interfaz definida (CLI/API/librer√≠a) con versionado (algorithm_build_id) y entradas/salidas determin√≠sticas o con tolerancia definida.", "owner": "Backend/Quant", "roles": "Quant; Backend; DevOps", "estatus": "BACKLOG", "dependencias": "RM-022", "in_degree": 1, "out_degree": 4}, "RM-022": {"area": "Validaci√≥n de algoritmo", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Constructor de datasets (feature matrix)", "requisito": "El sistema deber√° construir datasets de validaci√≥n desde datos normalizados (features, targets/labels si aplica) con ventanas temporales expl√≠citas y metadatos (schema_version, broker_set, feature_list).", "owner": "Quant/Backend", "roles": "Quant; Analista", "estatus": "BACKLOG", "dependencias": "RM-010", "in_degree": 1, "out_degree": 5}, "RM-023": {"area": "Validaci√≥n de algoritmo", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Runner de backtests/experimentos", "requisito": "El sistema deber√° ejecutar runs de validaci√≥n sobre datasets seleccionados, guardando par√°metros, logs, outputs, y m√©tricas de ejecuci√≥n. Debe soportar tipos de run (train/validate/test) si aplica.", "owner": "Quant/Backend", "roles": "Quant; Analista", "estatus": "BACKLOG", "dependencias": "RM-021,RM-022", "in_degree": 2, "out_degree": 8}, "RM-024": {"area": "Validaci√≥n de algoritmo", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "M√©tricas de evaluaci√≥n y scorecards", "requisito": "El sistema deber√° calcular m√©tricas de evaluaci√≥n (error, estabilidad, violaciones de constraints, uplift vs baseline) seg√∫n el objetivo del cliente, con thresholds configurables para pass/fail.", "owner": "Quant", "roles": "Quant; Analista; Viewer", "estatus": "BACKLOG", "dependencias": "RM-023,RM-013", "in_degree": 2, "out_degree": 4}, "RM-025": {"area": "Validaci√≥n de algoritmo", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Diagn√≥sticos y sensibilidad", "requisito": "El sistema deber√° generar diagn√≥sticos para runs (p.ej. an√°lisis de fallos, frecuencia de constraints activas, ablation/feature importance si aplica) y exportarlos en reporte t√©cnico.", "owner": "Quant", "roles": "Quant; Analista", "estatus": "BACKLOG", "dependencias": "RM-023,RM-024", "in_degree": 2, "out_degree": 1}, "RM-026": {"area": "Validaci√≥n de algoritmo", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "What-if y parameter sweeps", "requisito": "El sistema deber√° permitir ejecutar batch de escenarios (fees ¬±x, imputaci√≥n, distintos thresholds) y comparar resultados en una tabla/visualizaci√≥n √∫nica.", "owner": "Quant/Backend", "roles": "Quant; Analista", "estatus": "BACKLOG", "dependencias": "RM-023", "in_degree": 1, "out_degree": 1}, "RM-027": {"area": "Reportes", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Plantillas y generaci√≥n de reportes", "requisito": "El sistema deber√° generar reportes (HTML/PDF) a partir de plantillas con secciones: overview brokers, tablas de m√©tricas, scorecards de validaci√≥n, anomal√≠as y appendix de metodolog√≠a + versiones.", "owner": "Backend", "roles": "Analista; Viewer; Admin", "estatus": "BACKLOG", "dependencias": "RM-014,RM-024,RM-020", "in_degree": 3, "out_degree": 3}, "RM-028": {"area": "Reportes", "prioridad": "Baja (P2)", "version": "v0.3", "funcionalidad": "Distribuci√≥n programada", "requisito": "El sistema deber√° soportar generaci√≥n y distribuci√≥n programada de reportes (link seguro, email y/o webhook), con reintentos y alertas de falla.", "owner": "Backend/DevOps", "roles": "Admin; DevOps; Sistema", "estatus": "BACKLOG", "dependencias": "RM-027,RM-004,RM-034", "in_degree": 3, "out_degree": 1}, "RM-029": {"area": "Dashboard", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Vistas core del dashboard", "requisito": "El sistema deber√° proveer dashboard con: lista de brokers + filtros, p√°gina detalle broker con charts, y resumen de validaci√≥n del algoritmo; debe soportar drill-down a lineage.", "owner": "Frontend", "roles": "Viewer; Analista; Admin", "estatus": "BACKLOG", "dependencias": "RM-014,RM-017,RM-020,RM-033,RM-034", "in_degree": 5, "out_degree": 2}, "RM-030": {"area": "Dashboard", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Comparaciones y rankings", "requisito": "El sistema deber√° permitir comparaci√≥n side-by-side de brokers y tablas de ranking con columnas configurables, ordenamiento y exportaci√≥n.", "owner": "Frontend", "roles": "Viewer; Analista", "estatus": "BACKLOG", "dependencias": "RM-017,RM-032,RM-018,RM-019", "in_degree": 4, "out_degree": 1}, "RM-031": {"area": "Dashboard", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Explorador de runs/experimentos", "requisito": "El sistema deber√° proveer UI para explorar runs (filtros por versi√≥n, par√°metros, fecha, estado) y comparar 2+ runs, mostrando diffs y scorecards.", "owner": "Frontend", "roles": "Analista; Quant", "estatus": "BACKLOG", "dependencias": "RM-023,RM-024,RM-034", "in_degree": 3, "out_degree": 1}, "RM-032": {"area": "Exportaci√≥n", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Exports de datos y resultados", "requisito": "El sistema deber√° exportar (CSV/JSON) registro de brokers, m√©tricas y resultados de runs con metadatos de schema y unidades; exports grandes deben ser as√≠ncronos.", "owner": "Backend", "roles": "Analista; Admin", "estatus": "BACKLOG", "dependencias": "RM-010,RM-013,RM-034", "in_degree": 3, "out_degree": 3}, "RM-033": {"area": "Seguridad", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Autenticaci√≥n", "requisito": "El sistema deber√° requerir autenticaci√≥n para dashboard, reportes y exports (email/password o SSO/OIDC), con sesiones seguras, CSRF donde aplique y pol√≠ticas de password.", "owner": "Backend/DevOps", "roles": "Admin; Viewer; Analista", "estatus": "BACKLOG", "dependencias": "‚Äî", "in_degree": 0, "out_degree": 3}, "RM-034": {"area": "Seguridad", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Autorizaci√≥n y roles (RBAC)", "requisito": "El sistema deber√° implementar RBAC (Admin, Analista, Viewer) controlando: alta/edici√≥n brokers, ejecuci√≥n runs, exports, cambios de pol√≠ticas y acceso a auditor√≠as.", "owner": "Backend/Frontend", "roles": "Admin; Analista; Viewer", "estatus": "BACKLOG", "dependencias": "RM-033", "in_degree": 1, "out_degree": 6}, "RM-035": {"area": "Seguridad", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Gesti√≥n de secretos", "requisito": "El sistema deber√° gestionar secretos (API keys, SMTP, webhooks) fuera del repositorio (env/secret manager) y activar detecci√≥n de secretos en CI.", "owner": "DevOps", "roles": "DevOps", "estatus": "BACKLOG", "dependencias": "RM-043", "in_degree": 1, "out_degree": 2}, "RM-036": {"area": "Observabilidad", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Logging estructurado con correlaci√≥n", "requisito": "El sistema deber√° emitir logs estructurados (JSON) para ingesta, transformaci√≥n, m√©tricas y runs con correlation_id (run_id, broker_id, job_id) y niveles consistentes.", "owner": "DevOps", "roles": "DevOps; Backend", "estatus": "BACKLOG", "dependencias": "RM-004,RM-023", "in_degree": 2, "out_degree": 4}, "RM-037": {"area": "Observabilidad", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "M√©tricas y alertas operativas", "requisito": "El sistema deber√° exponer m√©tricas (duraci√≥n de jobs, tasa de √©xito, errores de scraping, latencia API) y alertas por umbrales (p.ej. fallas >X%, retrasos).", "owner": "DevOps", "roles": "DevOps; Admin", "estatus": "BACKLOG", "dependencias": "RM-036", "in_degree": 1, "out_degree": 1}, "RM-038": {"area": "Performance", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Throughput del pipeline", "requisito": "El sistema deber√° procesar al menos 100 URLs end-to-end dentro de un SLA configurable (p.ej. <30 min) usando paralelismo sin violar rate limits por dominio.", "owner": "Backend/DevOps", "roles": "DevOps; Backend", "estatus": "BACKLOG", "dependencias": "RM-005,RM-004", "in_degree": 2, "out_degree": 1}, "RM-039": {"area": "Performance", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Responsividad del dashboard", "requisito": "El sistema deber√° mantener interacciones del dashboard con P95 <2s para consultas t√≠picas y <10s para consultas pesadas, mostrando indicador de progreso si aplica.", "owner": "Backend/Frontend", "roles": "Frontend; Backend", "estatus": "BACKLOG", "dependencias": "RM-029,RM-017", "in_degree": 2, "out_degree": 1}, "RM-040": {"area": "Reproducibilidad", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Versionado end-to-end de componentes", "requisito": "El sistema deber√° versionar y relacionar parsers, mapeos, definiciones de m√©tricas, datasets y builds del algoritmo, y asociarlos a cada run y reporte.", "owner": "Backend/Quant", "roles": "Quant; Backend", "estatus": "BACKLOG", "dependencias": "RM-009,RM-011,RM-013,RM-021,RM-022", "in_degree": 5, "out_degree": 1}, "RM-041": {"area": "Testing", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Suite de unit/integration/E2E", "requisito": "El sistema deber√° incluir pruebas autom√°ticas para parsers, transformaciones, m√©tricas y runner del algoritmo. Debe usar fixtures grabadas (no depender de sitios live) y seguir enfoque RED/GREEN.", "owner": "All", "roles": "Backend; Quant; Frontend", "estatus": "BACKLOG", "dependencias": "RM-006,RM-013,RM-023", "in_degree": 3, "out_degree": 3}, "RM-042": {"area": "Testing", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Data contract tests (schemas)", "requisito": "El sistema deber√° aplicar data contracts entre extracci√≥n‚Üínormalizaci√≥n‚Üídataset‚Üíalgoritmo (schemas versionados) y fallar CI ante cambios rompientes.", "owner": "Backend", "roles": "Backend; Quant", "estatus": "BACKLOG", "dependencias": "RM-010,RM-022,RM-021", "in_degree": 3, "out_degree": 1}, "RM-043": {"area": "DevOps", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "CI/CD + migraciones + rollback", "requisito": "El sistema deber√° contar con CI/CD para build, tests, deploy y migraciones DB, con promoci√≥n de ambientes (dev/stage/prod) y procedimiento de rollback probado.", "owner": "DevOps", "roles": "DevOps", "estatus": "BACKLOG", "dependencias": "RM-041,RM-035", "in_degree": 2, "out_degree": 3}, "RM-044": {"area": "Gobernanza de datos", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Retenci√≥n y archivado", "requisito": "El sistema deber√° definir pol√≠ticas de retenci√≥n para raw_records, snapshots, outputs de runs, logs y reportes (purga/archivado) sin dejar referencias hu√©rfanas.", "owner": "Backend/DevOps", "roles": "Admin; DevOps", "estatus": "BACKLOG", "dependencias": "RM-009,RM-023,RM-027", "in_degree": 3, "out_degree": 1}, "RM-045": {"area": "Gobernanza", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Bit√°cora de auditor√≠a de acciones cr√≠ticas", "requisito": "El sistema deber√° registrar eventos de auditor√≠a para: cambios de brokers/URLs, ejecuciones de runs, exports, cambios de roles, cambios de pol√≠ticas, y accesos a reportes/lineage.", "owner": "Backend", "roles": "Admin", "estatus": "BACKLOG", "dependencias": "RM-034", "in_degree": 1, "out_degree": 1}, "RM-046": {"area": "UX", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Transparencia de errores y remediaci√≥n", "requisito": "El sistema deber√° mostrar errores claros y accionables (parser roto, dominio bloqueado, datos insuficientes, run fallido), con pasos sugeridos y links a evidencia (logs/lineage).", "owner": "Frontend", "roles": "Viewer; Analista; Admin", "estatus": "BACKLOG", "dependencias": "RM-019,RM-036,RM-020", "in_degree": 3, "out_degree": 1}, "RM-047": {"area": "Privacidad", "prioridad": "Baja (P2)", "version": "v0.3", "funcionalidad": "Minimizaci√≥n y redacci√≥n de datos", "requisito": "El sistema deber√° almacenar s√≥lo campos necesarios y permitir redacci√≥n/omisi√≥n de campos sensibles (si aparecen) en salidas (dash/report/export) seg√∫n pol√≠tica.", "owner": "Backend/DevOps", "roles": "Admin; DevOps", "estatus": "BACKLOG", "dependencias": "RM-036,RM-032", "in_degree": 2, "out_degree": 1}, "RM-048": {"area": "Documentaci√≥n", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Docs t√©cnicas y operativas", "requisito": "El sistema deber√° incluir documentaci√≥n: setup local, despliegue, runbooks, cat√°logo de m√©tricas, c√≥mo agregar un nuevo dominio/adaptador y c√≥mo ejecutar validaci√≥n del algoritmo.", "owner": "All", "roles": "All", "estatus": "BACKLOG", "dependencias": "RM-043", "in_degree": 1, "out_degree": 1}, "RM-049": {"area": "Extensibilidad", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Onboarding de nuevo dominio/fuente", "requisito": "El sistema deber√° ofrecer un proceso est√°ndar (template de adapter + mapping + fixtures + tests) para agregar un nuevo dominio en <=1 d√≠a para un sitio t√≠pico.", "owner": "Backend", "roles": "Backend; Quant", "estatus": "BACKLOG", "dependencias": "RM-006,RM-011,RM-041", "in_degree": 3, "out_degree": 1}, "RM-050": {"area": "Entregables", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Criterio de aceptaci√≥n del MVP", "requisito": "El MVP deber√° incluir: registro de brokers+URLs, scheduler, extracci√≥n+normalizaci√≥n, m√©tricas core, dashboard b√°sico, construcci√≥n de dataset, ejecuci√≥n de runs, scorecard, y generaci√≥n de reportes con versionado/lineage.", "owner": "PM/All", "roles": "PM; Admin; Analista", "estatus": "BACKLOG", "dependencias": "RM-001..RM-049", "in_degree": 49, "out_degree": 0}};
        const subgraphData = {"RM-001": {"ancestors": [], "descendants": ["RM-027", "RM-046", "RM-043", "RM-031", "RM-038", "RM-047", "RM-008", "RM-029", "RM-048", "RM-009", "RM-040", "RM-044", "RM-017", "RM-003", "RM-015", "RM-010", "RM-007", "RM-030", "RM-022", "RM-025", "RM-013", "RM-041", "RM-012", "RM-036", "RM-016", "RM-028", "RM-020", "RM-002", "RM-039", "RM-026", "RM-042", "RM-011", "RM-018", "RM-006", "RM-050", "RM-049", "RM-004", "RM-032", "RM-035", "RM-037", "RM-019", "RM-021", "RM-024", "RM-023", "RM-014", "RM-005"]}, "RM-002": {"ancestors": ["RM-001"], "descendants": ["RM-027", "RM-043", "RM-046", "RM-031", "RM-038", "RM-047", "RM-008", "RM-029", "RM-048", "RM-009", "RM-040", "RM-044", "RM-017", "RM-003", "RM-015", "RM-010", "RM-007", "RM-030", "RM-022", "RM-025", "RM-013", "RM-041", "RM-012", "RM-036", "RM-016", "RM-028", "RM-020", "RM-039", "RM-026", "RM-042", "RM-011", "RM-018", "RM-006", "RM-050", "RM-049", "RM-032", "RM-035", "RM-037", "RM-019", "RM-021", "RM-024", "RM-023", "RM-014", "RM-005"]}, "RM-003": {"ancestors": ["RM-001", "RM-002"], "descendants": ["RM-027", "RM-043", "RM-046", "RM-031", "RM-038", "RM-047", "RM-008", "RM-029", "RM-048", "RM-009", "RM-040", "RM-044", "RM-017", "RM-015", "RM-010", "RM-007", "RM-030", "RM-022", "RM-025", "RM-013", "RM-041", "RM-012", "RM-036", "RM-016", "RM-028", "RM-020", "RM-039", "RM-026", "RM-042", "RM-011", "RM-018", "RM-006", "RM-050", "RM-049", "RM-032", "RM-035", "RM-037", "RM-019", "RM-021", "RM-024", "RM-023", "RM-014", "RM-005"]}, "RM-004": {"ancestors": ["RM-001"], "descendants": ["RM-027", "RM-046", "RM-043", "RM-038", "RM-047", "RM-008", "RM-029", "RM-048", "RM-009", "RM-040", "RM-044", "RM-017", "RM-015", "RM-010", "RM-007", "RM-030", "RM-022", "RM-025", "RM-013", "RM-041", "RM-012", "RM-036", "RM-016", "RM-028", "RM-020", "RM-039", "RM-026", "RM-042", "RM-011", "RM-018", "RM-006", "RM-050", "RM-049", "RM-032", "RM-035", "RM-037", "RM-019", "RM-021", "RM-024", "RM-023", "RM-014", "RM-031"]}, "RM-005": {"ancestors": ["RM-003", "RM-001", "RM-002"], "descendants": ["RM-027", "RM-043", "RM-046", "RM-038", "RM-047", "RM-008", "RM-029", "RM-048", "RM-009", "RM-040", "RM-044", "RM-017", "RM-015", "RM-010", "RM-007", "RM-030", "RM-022", "RM-025", "RM-013", "RM-041", "RM-012", "RM-036", "RM-016", "RM-028", "RM-020", "RM-039", "RM-026", "RM-042", "RM-011", "RM-018", "RM-006", "RM-050", "RM-049", "RM-032", "RM-035", "RM-037", "RM-019", "RM-021", "RM-024", "RM-023", "RM-014", "RM-031"]}, "RM-006": {"ancestors": ["RM-004", "RM-002", "RM-003", "RM-005", "RM-001"], "descendants": ["RM-027", "RM-043", "RM-046", "RM-047", "RM-008", "RM-029", "RM-048", "RM-009", "RM-040", "RM-044", "RM-017", "RM-015", "RM-010", "RM-007", "RM-030", "RM-022", "RM-025", "RM-013", "RM-041", "RM-012", "RM-036", "RM-016", "RM-028", "RM-020", "RM-039", "RM-026", "RM-042", "RM-011", "RM-018", "RM-050", "RM-049", "RM-032", "RM-035", "RM-037", "RM-019", "RM-021", "RM-024", "RM-023", "RM-014", "RM-031"]}, "RM-007": {"ancestors": ["RM-004", "RM-002", "RM-006", "RM-003", "RM-005", "RM-001"], "descendants": ["RM-050"]}, "RM-008": {"ancestors": ["RM-004", "RM-002", "RM-006", "RM-003", "RM-005", "RM-001"], "descendants": ["RM-050"]}, "RM-009": {"ancestors": ["RM-004", "RM-002", "RM-006", "RM-003", "RM-005", "RM-001"], "descendants": ["RM-027", "RM-046", "RM-043", "RM-047", "RM-029", "RM-048", "RM-017", "RM-040", "RM-044", "RM-015", "RM-010", "RM-030", "RM-022", "RM-025", "RM-013", "RM-041", "RM-012", "RM-036", "RM-016", "RM-028", "RM-020", "RM-039", "RM-026", "RM-042", "RM-011", "RM-018", "RM-050", "RM-049", "RM-032", "RM-035", "RM-037", "RM-019", "RM-021", "RM-024", "RM-023", "RM-014", "RM-031"]}, "RM-010": {"ancestors": ["RM-004", "RM-002", "RM-009", "RM-006", "RM-003", "RM-005", "RM-001"], "descendants": ["RM-027", "RM-046", "RM-043", "RM-047", "RM-029", "RM-048", "RM-017", "RM-040", "RM-044", "RM-015", "RM-030", "RM-022", "RM-025", "RM-013", "RM-041", "RM-012", "RM-036", "RM-016", "RM-028", "RM-020", "RM-039", "RM-026", "RM-042", "RM-011", "RM-018", "RM-050", "RM-049", "RM-032", "RM-035", "RM-037", "RM-019", "RM-021", "RM-024", "RM-023", "RM-014", "RM-031"]}, "RM-011": {"ancestors": ["RM-004", "RM-002", "RM-009", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050", "RM-046", "RM-049", "RM-030", "RM-019", "RM-012", "RM-040"]}, "RM-012": {"ancestors": ["RM-004", "RM-002", "RM-011", "RM-009", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-013": {"ancestors": ["RM-004", "RM-002", "RM-009", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-027", "RM-046", "RM-043", "RM-047", "RM-029", "RM-048", "RM-017", "RM-040", "RM-044", "RM-015", "RM-030", "RM-025", "RM-041", "RM-016", "RM-028", "RM-020", "RM-039", "RM-018", "RM-050", "RM-049", "RM-032", "RM-035", "RM-019", "RM-024", "RM-014", "RM-031"]}, "RM-014": {"ancestors": ["RM-004", "RM-002", "RM-013", "RM-009", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-027", "RM-050", "RM-046", "RM-030", "RM-028", "RM-039", "RM-019", "RM-029", "RM-018", "RM-017", "RM-044"]}, "RM-015": {"ancestors": ["RM-004", "RM-002", "RM-013", "RM-009", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-016": {"ancestors": ["RM-020", "RM-004", "RM-002", "RM-013", "RM-009", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-017": {"ancestors": ["RM-004", "RM-002", "RM-013", "RM-003", "RM-009", "RM-006", "RM-014", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-039", "RM-050", "RM-030", "RM-029"]}, "RM-018": {"ancestors": ["RM-004", "RM-002", "RM-013", "RM-003", "RM-009", "RM-006", "RM-014", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050", "RM-030"]}, "RM-019": {"ancestors": ["RM-004", "RM-002", "RM-013", "RM-003", "RM-011", "RM-009", "RM-006", "RM-014", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050", "RM-046", "RM-030"]}, "RM-020": {"ancestors": ["RM-004", "RM-002", "RM-013", "RM-009", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-027", "RM-046", "RM-050", "RM-028", "RM-039", "RM-029", "RM-044", "RM-016"]}, "RM-021": {"ancestors": ["RM-004", "RM-022", "RM-002", "RM-009", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-027", "RM-046", "RM-043", "RM-047", "RM-048", "RM-040", "RM-044", "RM-025", "RM-041", "RM-036", "RM-028", "RM-026", "RM-042", "RM-050", "RM-049", "RM-035", "RM-037", "RM-024", "RM-023", "RM-031"]}, "RM-022": {"ancestors": ["RM-004", "RM-002", "RM-009", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-027", "RM-046", "RM-043", "RM-047", "RM-048", "RM-040", "RM-044", "RM-025", "RM-041", "RM-036", "RM-028", "RM-026", "RM-042", "RM-050", "RM-049", "RM-035", "RM-037", "RM-021", "RM-024", "RM-023", "RM-031"]}, "RM-023": {"ancestors": ["RM-004", "RM-022", "RM-002", "RM-021", "RM-009", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050", "RM-027", "RM-046", "RM-043", "RM-049", "RM-028", "RM-025", "RM-037", "RM-026", "RM-035", "RM-047", "RM-041", "RM-024", "RM-048", "RM-044", "RM-031", "RM-036"]}, "RM-024": {"ancestors": ["RM-004", "RM-022", "RM-002", "RM-013", "RM-021", "RM-009", "RM-023", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-027", "RM-050", "RM-028", "RM-025", "RM-044", "RM-031"]}, "RM-025": {"ancestors": ["RM-004", "RM-022", "RM-002", "RM-013", "RM-021", "RM-024", "RM-009", "RM-023", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-026": {"ancestors": ["RM-004", "RM-022", "RM-002", "RM-021", "RM-009", "RM-023", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-027": {"ancestors": ["RM-020", "RM-022", "RM-004", "RM-013", "RM-002", "RM-021", "RM-003", "RM-024", "RM-009", "RM-023", "RM-006", "RM-014", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050", "RM-028", "RM-044"]}, "RM-028": {"ancestors": ["RM-027", "RM-004", "RM-020", "RM-022", "RM-013", "RM-002", "RM-021", "RM-003", "RM-034", "RM-024", "RM-009", "RM-033", "RM-023", "RM-006", "RM-014", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-029": {"ancestors": ["RM-020", "RM-004", "RM-002", "RM-013", "RM-003", "RM-034", "RM-017", "RM-009", "RM-033", "RM-006", "RM-014", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-039", "RM-050"]}, "RM-030": {"ancestors": ["RM-032", "RM-004", "RM-002", "RM-013", "RM-019", "RM-003", "RM-034", "RM-018", "RM-017", "RM-011", "RM-009", "RM-033", "RM-006", "RM-014", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-031": {"ancestors": ["RM-004", "RM-022", "RM-002", "RM-013", "RM-021", "RM-034", "RM-024", "RM-009", "RM-033", "RM-023", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-032": {"ancestors": ["RM-004", "RM-002", "RM-013", "RM-034", "RM-009", "RM-033", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050", "RM-047", "RM-030"]}, "RM-033": {"ancestors": [], "descendants": ["RM-050", "RM-028", "RM-032", "RM-030", "RM-039", "RM-045", "RM-047", "RM-029", "RM-034", "RM-031"]}, "RM-034": {"ancestors": ["RM-033"], "descendants": ["RM-050", "RM-028", "RM-032", "RM-030", "RM-039", "RM-045", "RM-047", "RM-029", "RM-031"]}, "RM-035": {"ancestors": ["RM-043", "RM-004", "RM-022", "RM-002", "RM-013", "RM-021", "RM-041", "RM-009", "RM-023", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050", "RM-043", "RM-048"]}, "RM-036": {"ancestors": ["RM-004", "RM-022", "RM-002", "RM-021", "RM-009", "RM-023", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-037", "RM-046", "RM-050", "RM-047"]}, "RM-037": {"ancestors": ["RM-004", "RM-022", "RM-002", "RM-021", "RM-036", "RM-009", "RM-023", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-038": {"ancestors": ["RM-004", "RM-002", "RM-003", "RM-005", "RM-001"], "descendants": ["RM-050"]}, "RM-039": {"ancestors": ["RM-020", "RM-004", "RM-002", "RM-013", "RM-029", "RM-003", "RM-034", "RM-017", "RM-009", "RM-033", "RM-006", "RM-014", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-040": {"ancestors": ["RM-004", "RM-022", "RM-002", "RM-013", "RM-021", "RM-011", "RM-009", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-041": {"ancestors": ["RM-004", "RM-022", "RM-002", "RM-013", "RM-021", "RM-009", "RM-023", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050", "RM-043", "RM-049", "RM-035", "RM-048"]}, "RM-042": {"ancestors": ["RM-004", "RM-022", "RM-002", "RM-021", "RM-009", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-043": {"ancestors": ["RM-004", "RM-022", "RM-035", "RM-013", "RM-002", "RM-021", "RM-041", "RM-009", "RM-023", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-035", "RM-050", "RM-048"]}, "RM-044": {"ancestors": ["RM-027", "RM-020", "RM-022", "RM-004", "RM-013", "RM-002", "RM-021", "RM-003", "RM-009", "RM-024", "RM-023", "RM-006", "RM-014", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-045": {"ancestors": ["RM-034", "RM-033"], "descendants": ["RM-050"]}, "RM-046": {"ancestors": ["RM-020", "RM-004", "RM-001", "RM-013", "RM-022", "RM-002", "RM-019", "RM-021", "RM-003", "RM-011", "RM-009", "RM-023", "RM-006", "RM-014", "RM-005", "RM-036", "RM-010"], "descendants": ["RM-050"]}, "RM-047": {"ancestors": ["RM-004", "RM-032", "RM-022", "RM-013", "RM-002", "RM-021", "RM-003", "RM-034", "RM-009", "RM-033", "RM-023", "RM-006", "RM-001", "RM-005", "RM-036", "RM-010"], "descendants": ["RM-050"]}, "RM-048": {"ancestors": ["RM-043", "RM-004", "RM-022", "RM-035", "RM-013", "RM-002", "RM-021", "RM-041", "RM-009", "RM-023", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-049": {"ancestors": ["RM-004", "RM-022", "RM-002", "RM-013", "RM-021", "RM-011", "RM-041", "RM-009", "RM-023", "RM-006", "RM-003", "RM-005", "RM-001", "RM-010"], "descendants": ["RM-050"]}, "RM-050": {"ancestors": ["RM-027", "RM-043", "RM-046", "RM-031", "RM-045", "RM-038", "RM-047", "RM-008", "RM-029", "RM-048", "RM-009", "RM-017", "RM-040", "RM-044", "RM-003", "RM-015", "RM-010", "RM-007", "RM-030", "RM-022", "RM-025", "RM-013", "RM-034", "RM-041", "RM-012", "RM-001", "RM-016", "RM-036", "RM-028", "RM-020", "RM-002", "RM-039", "RM-026", "RM-042", "RM-011", "RM-018", "RM-006", "RM-049", "RM-004", "RM-032", "RM-035", "RM-037", "RM-019", "RM-021", "RM-024", "RM-033", "RM-023", "RM-014", "RM-005"], "descendants": []}};
        const areaColors = {"Ingesta": "#4ECDC4", "Extracci\u00f3n": "#FF6B6B", "Modelo de datos": "#45B7D1", "Normalizaci\u00f3n": "#96CEB4", "Transformaci\u00f3n": "#96CEB4", "M\u00e9tricas": "#FFD93D", "Dataset": "#DDA0DD", "Algoritmo": "#98D8C8", "Backtest": "#F7DC6F", "Reportes": "#BB8FCE", "UI/UX": "#85C1E9", "Dashboard": "#85C1E9", "Seguridad": "#F1948A", "Observabilidad": "#ABEBC6", "Testing": "#F5B041", "DevOps": "#AED6F1", "Gobernanza de datos": "#D7BDE2", "Gobernanza": "#D7BDE2", "Privacidad": "#FADBD8", "Documentaci\u00f3n": "#D5DBDB", "Extensibilidad": "#A9DFBF", "Entregables": "#FAD7A0", "UX": "#85C1E9", "Calidad de datos": "#82E0AA", "Auditabilidad": "#F9E79F", "Exportaci\u00f3n": "#D2B4DE", "Reproducibilidad": "#AEB6BF", "Performance": "#F5CBA7", "Validaci\u00f3n de algoritmo": "#76D7C4"};
        const totalNodes = 50;
        const totalEdges = 141;

        // State
        let selectedNodeId = null;
        let currentLayout = 'force';
        let visibleNodeIds = new Set(Object.keys(nodeData));

        // Wait for network to be ready
        function waitForNetwork(callback) {
            if (typeof network !== 'undefined' && network) {
                callback();
            } else {
                setTimeout(() => waitForNetwork(callback), 100);
            }
        }

        // Initialize when ready
        waitForNetwork(function() {
            console.log('Network ready, initializing custom controls...');
            initializeApp();
        });

        function initializeApp() {
            // Initial table render
            updateTable();

            // Bind event handlers
            bindEventHandlers();

            // Setup network event handlers
            setupNetworkHandlers();
        }

        function bindEventHandlers() {
            // Search button
            document.getElementById('btn-search').addEventListener('click', focusNode);

            // Search input enter key
            document.getElementById('node-search').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') focusNode();
            });

            // Filter dropdowns
            document.getElementById('area-filter').addEventListener('change', applyFilters);
            document.getElementById('priority-filter').addEventListener('change', applyFilters);
            document.getElementById('version-filter').addEventListener('change', applyFilters);

            // Exploration buttons
            document.getElementById('btn-ancestors').addEventListener('click', showAncestors);
            document.getElementById('btn-descendants').addEventListener('click', showDescendants);
            document.getElementById('btn-neighborhood').addEventListener('click', showNeighborhood);

            // Layout buttons
            document.getElementById('layout-force').addEventListener('click', () => setLayout('force'));
            document.getElementById('layout-tree').addEventListener('click', () => setLayout('tree'));

            // Reset button
            document.getElementById('btn-reset').addEventListener('click', resetView);

            // Legend clicks
            document.querySelectorAll('.legend-item').forEach(item => {
                item.addEventListener('click', function() {
                    const area = this.getAttribute('data-area');
                    document.getElementById('area-filter').value = area;
                    applyFilters();
                });
            });
        }

        function setupNetworkHandlers() {
            // Click handler
            network.on('click', function(params) {
                if (params.nodes.length > 0) {
                    selectedNodeId = params.nodes[0];
                    showSelectedInfo(selectedNodeId);
                } else {
                    selectedNodeId = null;
                    hideSelectedInfo();
                }
            });

            // Hover tooltip
            const tooltip = document.getElementById('hover-tooltip');

            network.on('hoverNode', function(params) {
                const nodeId = params.node;
                const data = nodeData[nodeId];
                if (!data) return;

                const color = areaColors[data.area] || '#888888';
                tooltip.innerHTML = `
                    <h4 style="color: ${color}">${nodeId}: ${data.funcionalidad}</h4>
                    <div class="tooltip-row">
                        <span class="tooltip-label">√Årea:</span>
                        <span class="tooltip-value">${data.area}</span>
                    </div>
                    <div class="tooltip-row">
                        <span class="tooltip-label">Prioridad:</span>
                        <span class="tooltip-value">${data.prioridad}</span>
                    </div>
                    <div class="tooltip-row">
                        <span class="tooltip-label">Versi√≥n:</span>
                        <span class="tooltip-value">${data.version}</span>
                    </div>
                    <div class="tooltip-row">
                        <span class="tooltip-label">Owner:</span>
                        <span class="tooltip-value">${data.owner}</span>
                    </div>
                    <div class="tooltip-row">
                        <span class="tooltip-label">Dependencias:</span>
                        <span class="tooltip-value">${data.dependencias}</span>
                    </div>
                    <div class="tooltip-requisito">${data.requisito}</div>
                `;
                tooltip.style.display = 'block';
            });

            network.on('blurNode', function() {
                tooltip.style.display = 'none';
            });

            // Tooltip follows mouse
            document.querySelector('.graph-panel').addEventListener('mousemove', function(e) {
                if (tooltip.style.display === 'block') {
                    const x = e.clientX + 15;
                    const y = e.clientY + 15;
                    const rect = tooltip.getBoundingClientRect();
                    const maxX = window.innerWidth - rect.width - 20;
                    const maxY = window.innerHeight - rect.height - 20;
                    tooltip.style.left = Math.min(x, maxX) + 'px';
                    tooltip.style.top = Math.min(y, maxY) + 'px';
                }
            });
        }

        function focusNode() {
            const input = document.getElementById('node-search').value.trim().toUpperCase();
            if (!input) {
                alert('Por favor ingresa un ID de requisito (ej: RM-001)');
                return;
            }

            if (nodeData[input]) {
                network.focus(input, {
                    scale: 1.5,
                    animation: { duration: 500, easingFunction: 'easeInOutQuad' }
                });
                network.selectNodes([input]);
                selectedNodeId = input;
                showSelectedInfo(input);
            } else {
                alert('Nodo no encontrado: ' + input + '\n\nAseg√∫rate de usar el formato correcto (ej: RM-001)');
            }
        }

        function applyFilters() {
            const areaFilter = document.getElementById('area-filter').value;
            const priorityFilter = document.getElementById('priority-filter').value;
            const versionFilter = document.getElementById('version-filter').value;

            visibleNodeIds = new Set();

            Object.keys(nodeData).forEach(nodeId => {
                const data = nodeData[nodeId];
                const matchArea = !areaFilter || data.area === areaFilter;
                const matchPriority = !priorityFilter || data.prioridad === priorityFilter;
                const matchVersion = !versionFilter || data.version === versionFilter;

                if (matchArea && matchPriority && matchVersion) {
                    visibleNodeIds.add(nodeId);
                }
            });

            updateVisibility();
            updateTable();
            updateStats();
        }

        function updateVisibility() {
            const nodeUpdates = Object.keys(nodeData).map(id => ({
                id: id,
                hidden: !visibleNodeIds.has(id)
            }));
            nodes.update(nodeUpdates);

            const edgeUpdates = edges.get().map(edge => ({
                id: edge.id,
                hidden: !visibleNodeIds.has(edge.from) || !visibleNodeIds.has(edge.to)
            }));
            edges.update(edgeUpdates);

            setTimeout(() => {
                network.fit({ animation: { duration: 300 } });
            }, 100);
        }

        function updateTable() {
            const tbody = document.getElementById('table-body');
            const sortedIds = Array.from(visibleNodeIds).sort();

            let html = '';
            sortedIds.forEach(id => {
                const data = nodeData[id];
                const priorityClass = data.prioridad.includes('P0') ? 'priority-p0' :
                                      data.prioridad.includes('P1') ? 'priority-p1' : 'priority-p2';

                html += `
                    <tr data-id="${id}" style="cursor: pointer;">
                        <td class="id-cell">${id}</td>
                        <td class="area-cell">${data.area}</td>
                        <td class="func-cell">${data.funcionalidad}</td>
                        <td><span class="priority-badge ${priorityClass}">${data.prioridad}</span></td>
                        <td>${data.version}</td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
            document.getElementById('table-count').textContent = visibleNodeIds.size + ' requisitos';

            // Add click handlers to table rows
            tbody.querySelectorAll('tr').forEach(row => {
                row.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    network.focus(id, {
                        scale: 1.5,
                        animation: { duration: 500 }
                    });
                    network.selectNodes([id]);
                    selectedNodeId = id;
                    showSelectedInfo(id);
                });
            });
        }

        function updateStats() {
            document.getElementById('visible-nodes').textContent = visibleNodeIds.size;
            const visibleEdgeCount = edges.get().filter(e =>
                visibleNodeIds.has(e.from) && visibleNodeIds.has(e.to)
            ).length;
            document.getElementById('visible-edges').textContent = visibleEdgeCount;
        }

        function showSelectedInfo(nodeId) {
            const data = nodeData[nodeId];
            if (!data) return;

            document.getElementById('sel-id').textContent = nodeId;
            document.getElementById('sel-area').textContent = data.area;
            document.getElementById('sel-priority').textContent = data.prioridad;
            document.getElementById('sel-deps').textContent = data.dependencias;
            document.getElementById('selected-title').textContent = data.funcionalidad;
            document.getElementById('selected-info').classList.add('visible');
        }

        function hideSelectedInfo() {
            document.getElementById('selected-info').classList.remove('visible');
        }

        function showAncestors() {
            if (!selectedNodeId) {
                alert('Primero selecciona un nodo haciendo clic en el grafo');
                return;
            }
            const ancestors = subgraphData[selectedNodeId]?.ancestors || [];
            visibleNodeIds = new Set([selectedNodeId, ...ancestors]);
            updateVisibility();
            updateTable();
            updateStats();
        }

        function showDescendants() {
            if (!selectedNodeId) {
                alert('Primero selecciona un nodo haciendo clic en el grafo');
                return;
            }
            const descendants = subgraphData[selectedNodeId]?.descendants || [];
            visibleNodeIds = new Set([selectedNodeId, ...descendants]);
            updateVisibility();
            updateTable();
            updateStats();
        }

        function showNeighborhood() {
            if (!selectedNodeId) {
                alert('Primero selecciona un nodo haciendo clic en el grafo');
                return;
            }
            const neighbors = new Set([selectedNodeId]);
            edges.get().forEach(edge => {
                if (edge.from === selectedNodeId) neighbors.add(edge.to);
                if (edge.to === selectedNodeId) neighbors.add(edge.from);
            });
            visibleNodeIds = neighbors;
            updateVisibility();
            updateTable();
            updateStats();
        }

        function setLayout(layout) {
            currentLayout = layout;

            // Update button states
            document.getElementById('layout-force').classList.toggle('active', layout === 'force');
            document.getElementById('layout-tree').classList.toggle('active', layout === 'tree');

            if (layout === 'tree') {
                network.setOptions({
                    layout: {
                        hierarchical: {
                            enabled: true,
                            direction: 'UD',
                            sortMethod: 'directed',
                            levelSeparation: 100,
                            nodeSpacing: 120,
                            treeSpacing: 150,
                            blockShifting: true,
                            edgeMinimization: true,
                            parentCentralization: true
                        }
                    },
                    physics: {
                        enabled: false
                    }
                });
            } else {
                network.setOptions({
                    layout: {
                        hierarchical: {
                            enabled: false
                        }
                    },
                    physics: {
                        enabled: true,
                        solver: 'forceAtlas2Based',
                        forceAtlas2Based: {
                            gravitationalConstant: -80,
                            centralGravity: 0.01,
                            springLength: 150,
                            springConstant: 0.08,
                            damping: 0.4,
                            avoidOverlap: 0.8
                        }
                    }
                });
            }

            setTimeout(() => {
                network.fit({ animation: { duration: 500 } });
            }, 300);
        }

        function resetView() {
            // Clear filters
            document.getElementById('area-filter').value = '';
            document.getElementById('priority-filter').value = '';
            document.getElementById('version-filter').value = '';
            document.getElementById('node-search').value = '';

            // Show all nodes
            visibleNodeIds = new Set(Object.keys(nodeData));
            updateVisibility();
            updateTable();

            // Reset stats
            document.getElementById('visible-nodes').textContent = totalNodes;
            document.getElementById('visible-edges').textContent = totalEdges;

            // Deselect
            network.unselectAll();
            selectedNodeId = null;
            hideSelectedInfo();

            // Reset layout to force
            if (currentLayout === 'tree') {
                setLayout('force');
            }

            network.fit({ animation: { duration: 500 } });
        }
    })();
    </script>
    </body></html>
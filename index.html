<html>
    <head>
        <meta charset="utf-8">
        
            <script src="lib/bindings/utils.js"></script>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/dist/vis-network.min.css" integrity="sha512-WgxfT5LWjfszlPHXRmBWHkV2eceiWTOBvrKCNbdgDYTHrT2AeLCGbF4sZlZw3UMN3WtL0tGUoIAKsu8mllg/XA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
            <script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/vis-network.min.js" integrity="sha512-LnvoEWDFrqGHlHmDD2101OrLcbsfkrzoSpvtSQtxK3RMnRV0eOkhhBN2dXHKRrUU8p2DGRTk35n4O8nWSVe1mQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            
                <link href="lib/tom-select/tom-select.css" rel="stylesheet">
                <script src="lib/tom-select/tom-select.complete.min.js"></script>
            
        
<center>
<h1></h1>
</center>

<!-- <link rel="stylesheet" href="../node_modules/vis/dist/vis.min.css" type="text/css" />
<script type="text/javascript" src="../node_modules/vis/dist/vis.js"> </script>-->
        <link
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
          crossorigin="anonymous"
        />
        <script
          src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
          crossorigin="anonymous"
        ></script>


        <center>
          <h1></h1>
        </center>
        <style type="text/css">

             #mynetwork {
                 width: 100%;
                 height: 900px;
                 background-color: #1a1a2e;
                 border: 1px solid lightgray;
                 position: relative;
                 float: left;
             }

             

             

             
        </style>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #1a1a2e;
            overflow: hidden;
        }
        
        #controls {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(180deg, #16213e 0%, #1a1a2e 100%);
            padding: 15px 20px;
            z-index: 1000;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
            border-bottom: 1px solid #4a4a6a;
        }
        
        #controls h1 {
            color: #00ff88;
            margin: 0;
            font-size: 1.3em;
            font-weight: 600;
            margin-right: 20px;
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .control-group label {
            color: #8888aa;
            font-size: 0.85em;
            font-weight: 500;
        }
        
        .control-group select, .control-group input {
            background: #0f0f23;
            border: 1px solid #4a4a6a;
            color: #ffffff;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .control-group select:hover, .control-group input:hover {
            border-color: #00ff88;
        }
        
        .control-group select:focus, .control-group input:focus {
            outline: none;
            border-color: #00ff88;
            box-shadow: 0 0 10px rgba(0,255,136,0.3);
        }
        
        button {
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            border: none;
            color: #1a1a2e;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9em;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,255,136,0.4);
        }
        
        button.secondary {
            background: #4a4a6a;
            color: #ffffff;
        }
        
        button.secondary:hover {
            background: #5a5a7a;
        }
        
        #stats {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(22, 33, 62, 0.95);
            padding: 15px 20px;
            border-radius: 10px;
            color: #ffffff;
            font-size: 0.85em;
            z-index: 1000;
            border: 1px solid #4a4a6a;
            max-width: 280px;
        }
        
        #stats h3 {
            margin: 0 0 10px 0;
            color: #00ff88;
            font-size: 1em;
        }
        
        #stats p {
            margin: 5px 0;
            color: #aaaacc;
        }
        
        #stats span {
            color: #ffffff;
            font-weight: 600;
        }
        
        #legend {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(22, 33, 62, 0.95);
            padding: 15px 20px;
            border-radius: 10px;
            color: #ffffff;
            font-size: 0.8em;
            z-index: 1000;
            border: 1px solid #4a4a6a;
            max-height: 400px;
            overflow-y: auto;
        }
        
        #legend h3 {
            margin: 0 0 10px 0;
            color: #00ff88;
            font-size: 1em;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 5px 0;
            cursor: pointer;
            padding: 3px 5px;
            border-radius: 4px;
            transition: background 0.2s;
        }
        
        .legend-item:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        #mynetwork {
            margin-top: 70px;
            height: calc(100vh - 70px) !important;
        }
        
        #node-info {
            position: fixed;
            top: 80px;
            right: 20px;
            background: rgba(22, 33, 62, 0.95);
            padding: 15px 20px;
            border-radius: 10px;
            color: #ffffff;
            font-size: 0.85em;
            z-index: 1000;
            border: 1px solid #4a4a6a;
            max-width: 350px;
            display: none;
        }
        
        #node-info h3 {
            margin: 0 0 10px 0;
            color: #00ff88;
        }
        
        #node-info .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            cursor: pointer;
            color: #888;
            font-size: 1.2em;
        }
        
        #node-info .close-btn:hover {
            color: #fff;
        }
        
        .help-text {
            color: #6a6a8a;
            font-size: 0.8em;
            margin-left: auto;
        }

        /* Custom hover tooltip */
        #hover-tooltip {
            position: fixed;
            background: rgba(22, 33, 62, 0.98);
            padding: 15px 20px;
            border-radius: 10px;
            color: #ffffff;
            font-size: 0.85em;
            z-index: 2000;
            border: 1px solid #4a4a6a;
            max-width: 420px;
            pointer-events: none;
            display: none;
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
        }

        #hover-tooltip h4 {
            margin: 0 0 12px 0;
            color: #00ff88;
            font-size: 1.1em;
            border-bottom: 1px solid #4a4a6a;
            padding-bottom: 8px;
        }

        #hover-tooltip .tooltip-row {
            display: flex;
            margin: 6px 0;
            line-height: 1.4;
        }

        #hover-tooltip .tooltip-label {
            color: #8888aa;
            min-width: 100px;
            font-weight: 500;
        }

        #hover-tooltip .tooltip-value {
            color: #ffffff;
            flex: 1;
        }

        #hover-tooltip .tooltip-requisito {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #4a4a6a;
            line-height: 1.5;
            color: #ccccdd;
            font-size: 0.95em;
        }

        #hover-tooltip .tooltip-requisito-label {
            color: #8888aa;
            font-weight: 500;
            display: block;
            margin-bottom: 6px;
        }

        /* Layout toggle button styles */
        .layout-toggle {
            display: flex;
            gap: 0;
            border-radius: 6px;
            overflow: hidden;
            border: 1px solid #4a4a6a;
        }

        .layout-btn {
            background: #0f0f23;
            border: none;
            color: #8888aa;
            padding: 8px 14px;
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .layout-btn:hover {
            background: #1a1a3e;
            color: #ffffff;
        }

        .layout-btn.active {
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            color: #1a1a2e;
            font-weight: 600;
        }

        .layout-btn:first-child {
            border-right: 1px solid #4a4a6a;
        }
    </style>
    </head>


    <body>
    <div id="controls">
        <h1>üìä Requirements Dependency Graph - GIS Project</h1>
        
        <div class="control-group">
            <label>√Årea:</label>
            <select id="area-filter">
                <option value="">Todas</option>
                <option value="Auditabilidad">Auditabilidad</option><option value="Calidad de datos">Calidad de datos</option><option value="Dashboard">Dashboard</option><option value="DevOps">DevOps</option><option value="Documentaci√≥n">Documentaci√≥n</option><option value="Entregables">Entregables</option><option value="Exportaci√≥n">Exportaci√≥n</option><option value="Extensibilidad">Extensibilidad</option><option value="Extracci√≥n">Extracci√≥n</option><option value="Gobernanza">Gobernanza</option><option value="Gobernanza de datos">Gobernanza de datos</option><option value="Ingesta">Ingesta</option><option value="Modelo de datos">Modelo de datos</option><option value="M√©tricas">M√©tricas</option><option value="Observabilidad">Observabilidad</option><option value="Performance">Performance</option><option value="Privacidad">Privacidad</option><option value="Reportes">Reportes</option><option value="Reproducibilidad">Reproducibilidad</option><option value="Seguridad">Seguridad</option><option value="Testing">Testing</option><option value="Transformaci√≥n">Transformaci√≥n</option><option value="UX">UX</option><option value="Validaci√≥n de algoritmo">Validaci√≥n de algoritmo</option>
            </select>
        </div>
        
        <div class="control-group">
            <label>Prioridad:</label>
            <select id="priority-filter">
                <option value="">Todas</option>
                <option value="Alta (P0)">Alta (P0)</option><option value="Media (P1)">Media (P1)</option><option value="Baja (P2)">Baja (P2)</option>
            </select>
        </div>
        
        <div class="control-group">
            <label>Versi√≥n:</label>
            <select id="version-filter">
                <option value="">Todas</option>
                <option value="MVP v0.1">MVP v0.1</option><option value="v0.2">v0.2</option><option value="v0.3">v0.3</option>
            </select>
        </div>
        
        <div class="control-group">
            <label>Nodo:</label>
            <input type="text" id="node-search" placeholder="RM-001" style="width: 80px;">
            <button onclick="focusNode()">Buscar</button>
        </div>
        
        <div class="control-group">
            <button onclick="showAncestors()">‚Üê Dependencias</button>
            <button onclick="showDescendants()">Dependientes ‚Üí</button>
            <button onclick="showNeighborhood()">Vecindario</button>
        </div>

        <div class="control-group">
            <label>Layout:</label>
            <div class="layout-toggle">
                <button class="layout-btn active" id="layout-force" onclick="setLayout('force')">Fuerza</button>
                <button class="layout-btn" id="layout-tree" onclick="setLayout('tree')">√Årbol</button>
            </div>
        </div>

        <button class="secondary" onclick="resetView()">Reset</button>
        
        <span class="help-text">Click en nodo para seleccionar ‚Ä¢ Doble click para fijar ‚Ä¢ Scroll para zoom</span>
    </div>
    
    <div id="stats">
        <h3>üìà Estad√≠sticas</h3>
        <p>Nodos visibles: <span id="visible-nodes">50</span></p>
        <p>Aristas visibles: <span id="visible-edges">141</span></p>
        <p>Nodo seleccionado: <span id="selected-node">‚Äî</span></p>
        <p>In-degree: <span id="in-degree">‚Äî</span></p>
        <p>Out-degree: <span id="out-degree">‚Äî</span></p>
    </div>
    
    <div id="legend">
        <h3>üé® √Åreas</h3>
        <div class="legend-item" onclick="filterByArea('Auditabilidad')"><div class="legend-color" style="background: #F9E79F"></div><span>Auditabilidad</span></div><div class="legend-item" onclick="filterByArea('Calidad de datos')"><div class="legend-color" style="background: #82E0AA"></div><span>Calidad de datos</span></div><div class="legend-item" onclick="filterByArea('Dashboard')"><div class="legend-color" style="background: #85C1E9"></div><span>Dashboard</span></div><div class="legend-item" onclick="filterByArea('DevOps')"><div class="legend-color" style="background: #AED6F1"></div><span>DevOps</span></div><div class="legend-item" onclick="filterByArea('Documentaci√≥n')"><div class="legend-color" style="background: #D5DBDB"></div><span>Documentaci√≥n</span></div><div class="legend-item" onclick="filterByArea('Entregables')"><div class="legend-color" style="background: #FAD7A0"></div><span>Entregables</span></div><div class="legend-item" onclick="filterByArea('Exportaci√≥n')"><div class="legend-color" style="background: #D2B4DE"></div><span>Exportaci√≥n</span></div><div class="legend-item" onclick="filterByArea('Extensibilidad')"><div class="legend-color" style="background: #A9DFBF"></div><span>Extensibilidad</span></div><div class="legend-item" onclick="filterByArea('Extracci√≥n')"><div class="legend-color" style="background: #FF6B6B"></div><span>Extracci√≥n</span></div><div class="legend-item" onclick="filterByArea('Gobernanza')"><div class="legend-color" style="background: #D7BDE2"></div><span>Gobernanza</span></div><div class="legend-item" onclick="filterByArea('Gobernanza de datos')"><div class="legend-color" style="background: #D7BDE2"></div><span>Gobernanza de datos</span></div><div class="legend-item" onclick="filterByArea('Ingesta')"><div class="legend-color" style="background: #4ECDC4"></div><span>Ingesta</span></div><div class="legend-item" onclick="filterByArea('Modelo de datos')"><div class="legend-color" style="background: #45B7D1"></div><span>Modelo de datos</span></div><div class="legend-item" onclick="filterByArea('M√©tricas')"><div class="legend-color" style="background: #FFD93D"></div><span>M√©tricas</span></div><div class="legend-item" onclick="filterByArea('Observabilidad')"><div class="legend-color" style="background: #ABEBC6"></div><span>Observabilidad</span></div><div class="legend-item" onclick="filterByArea('Performance')"><div class="legend-color" style="background: #F5CBA7"></div><span>Performance</span></div><div class="legend-item" onclick="filterByArea('Privacidad')"><div class="legend-color" style="background: #FADBD8"></div><span>Privacidad</span></div><div class="legend-item" onclick="filterByArea('Reportes')"><div class="legend-color" style="background: #BB8FCE"></div><span>Reportes</span></div><div class="legend-item" onclick="filterByArea('Reproducibilidad')"><div class="legend-color" style="background: #AEB6BF"></div><span>Reproducibilidad</span></div><div class="legend-item" onclick="filterByArea('Seguridad')"><div class="legend-color" style="background: #F1948A"></div><span>Seguridad</span></div><div class="legend-item" onclick="filterByArea('Testing')"><div class="legend-color" style="background: #F5B041"></div><span>Testing</span></div><div class="legend-item" onclick="filterByArea('Transformaci√≥n')"><div class="legend-color" style="background: #96CEB4"></div><span>Transformaci√≥n</span></div><div class="legend-item" onclick="filterByArea('UX')"><div class="legend-color" style="background: #85C1E9"></div><span>UX</span></div><div class="legend-item" onclick="filterByArea('Validaci√≥n de algoritmo')"><div class="legend-color" style="background: #76D7C4"></div><span>Validaci√≥n de algoritmo</span></div>
    </div>
    
    <div id="node-info">
        <span class="close-btn" onclick="closeNodeInfo()">√ó</span>
        <h3 id="info-title">‚Äî</h3>
        <div id="info-content"></div>
        <div style="margin-top: 15px; display: flex; gap: 10px;">
            <button onclick="showAncestorsOf(selectedNodeId)">Ver dependencias</button>
            <button onclick="showDescendantsOf(selectedNodeId)">Ver dependientes</button>
        </div>
    </div>

    <div id="hover-tooltip"></div>
    
        <div class="card" style="width: 100%">
            
                <div id="select-menu" class="card-header">
                    <div class="row no-gutters">
                        <div class="col-10 pb-2">
                            <select
                            class="form-select"
                            aria-label="Default select example"
                            onchange="selectNode([value]);"
                            id="select-node"
                            placeholder="Select node..."
                            >
                                <option selected>Select a Node by ID</option>
                                
                                    <option value="RM-001">RM-001</option>
                                
                                    <option value="RM-002">RM-002</option>
                                
                                    <option value="RM-003">RM-003</option>
                                
                                    <option value="RM-004">RM-004</option>
                                
                                    <option value="RM-005">RM-005</option>
                                
                                    <option value="RM-006">RM-006</option>
                                
                                    <option value="RM-007">RM-007</option>
                                
                                    <option value="RM-008">RM-008</option>
                                
                                    <option value="RM-009">RM-009</option>
                                
                                    <option value="RM-010">RM-010</option>
                                
                                    <option value="RM-011">RM-011</option>
                                
                                    <option value="RM-012">RM-012</option>
                                
                                    <option value="RM-013">RM-013</option>
                                
                                    <option value="RM-014">RM-014</option>
                                
                                    <option value="RM-015">RM-015</option>
                                
                                    <option value="RM-016">RM-016</option>
                                
                                    <option value="RM-017">RM-017</option>
                                
                                    <option value="RM-018">RM-018</option>
                                
                                    <option value="RM-019">RM-019</option>
                                
                                    <option value="RM-020">RM-020</option>
                                
                                    <option value="RM-021">RM-021</option>
                                
                                    <option value="RM-022">RM-022</option>
                                
                                    <option value="RM-023">RM-023</option>
                                
                                    <option value="RM-024">RM-024</option>
                                
                                    <option value="RM-025">RM-025</option>
                                
                                    <option value="RM-026">RM-026</option>
                                
                                    <option value="RM-027">RM-027</option>
                                
                                    <option value="RM-028">RM-028</option>
                                
                                    <option value="RM-029">RM-029</option>
                                
                                    <option value="RM-030">RM-030</option>
                                
                                    <option value="RM-031">RM-031</option>
                                
                                    <option value="RM-032">RM-032</option>
                                
                                    <option value="RM-033">RM-033</option>
                                
                                    <option value="RM-034">RM-034</option>
                                
                                    <option value="RM-035">RM-035</option>
                                
                                    <option value="RM-036">RM-036</option>
                                
                                    <option value="RM-037">RM-037</option>
                                
                                    <option value="RM-038">RM-038</option>
                                
                                    <option value="RM-039">RM-039</option>
                                
                                    <option value="RM-040">RM-040</option>
                                
                                    <option value="RM-041">RM-041</option>
                                
                                    <option value="RM-042">RM-042</option>
                                
                                    <option value="RM-043">RM-043</option>
                                
                                    <option value="RM-044">RM-044</option>
                                
                                    <option value="RM-045">RM-045</option>
                                
                                    <option value="RM-046">RM-046</option>
                                
                                    <option value="RM-047">RM-047</option>
                                
                                    <option value="RM-048">RM-048</option>
                                
                                    <option value="RM-049">RM-049</option>
                                
                                    <option value="RM-050">RM-050</option>
                                
                            </select>
                        </div>
                        <div class="col-2 pb-2">
                            <button type="button" class="btn btn-primary btn-block" onclick="neighbourhoodHighlight({nodes: []});">Reset Selection</button>
                        </div>
                    </div>
                </div>
            
            
              <div id="filter-menu" class="card-header">
                <div class="row no-gutters">
                  <div class="col-3 pb-2">
                    <select
                            class="form-select"
                            aria-label="Default select example"
                            onchange="updateFilter(value, 'item')"
                            id="select-item"
                        >
                        <option value="">Select a network item</option>
                        <option value="edge">edge</option>
                        <option value="node">node</option>
                    </select>
                  </div>
                  <div class="col-3 pb-2">
                    <select
                            class="form-select"
                            aria-label="Default select example"
                            onchange="updateFilter(value, 'property')"
                            id="select-property"
                        >
                        <option value="">Select a property...</option>
                    </select>
                  </div>
                  <div class="col-3 pb-2">
                    <select
                            class="form-select"
                            aria-label="Default select example"
                            id="select-value"
                        >
                        <option value="">Select value(s)...</option>
                    </select>
                  </div>
                  <div class="col-1 pb-2">
                    <button type="button" class="btn btn-primary btn-block" onclick="highlightFilter(filter);">Filter</button>
                  </div>
                  <div class="col-2 pb-2">
                    <button type="button" class="btn btn-primary btn-block" onclick="clearFilter(true)">Reset Selection</button>
                  </div>
                </div>
              </div>
            
            <div id="mynetwork" class="card-body"></div>
        </div>

        
        

        <script type="text/javascript">

              // initialize global variables.
              var edges;
              var nodes;
              var allNodes;
              var allEdges;
              var nodeColors;
              var originalNodes;
              var network;
              var container;
              var options, data;
              var filter = {
                  item : '',
                  property : '',
                  value : []
              };

              
                  new TomSelect("#select-node",{
                      create: false,
                      sortField: {
                          field: "text",
                          direction: "asc"
                      }
                  });
              

              
                  // explicitly using onItemAdd and this function as we need to save multiple values
                  let updateValueFilter = function() {
                      return function () {
                      filter['value'].push(arguments[0])
                      }
                  }

                  let valueControl = new TomSelect("#select-value",{
                      maxItems: null,
                      valueField: 'id',
                      labelField: 'title',
                      searchField: 'title',
                      create: false,
                      sortField: {
                          field: "text",
                          direction: "asc"
                      },
                      onItemAdd: updateValueFilter()
                  });

                  let addValues = function() {
                      return function () {
                          // clear the current value options and add the selected attribute values
                          // tom-select handles duplicates
                          let selectedProperty = arguments[0];
                          valueControl.clear();
                          valueControl.clearOptions();
                          filter['value'] = []
                          if (filter['item'] === 'node') {
                              for (let each in allNodes) {
                                  valueControl.addOption({
                                      id:allNodes[each][selectedProperty],
                                      title:allNodes[each][selectedProperty]
                                  })
                              }
                          }
                          else if (filter['item'] === 'edge') {
                              for (let each in allEdges) {
                                  valueControl.addOption({
                                      id:allEdges[each][selectedProperty],
                                      title:allEdges[each][selectedProperty]
                                  })
                              }
                          }
                      }
                  };

                  let propControl = new TomSelect("#select-property",{
                      valueField: 'id',
                      labelField: 'title',
                      searchField: 'title',
                      create: false,
                      sortField: {
                          field: "text",
                          direction: "asc"
                      },
                      onItemAdd: addValues()
                  });

                  let addProperties = function() {
                      return function () {
                          // loops through the selected network item and adds the attributes to dropdown
                          // tom-select handles duplicates
                          clearFilter(false)
                          if (arguments[0] === 'edge') {
                              for (let each in allEdges) {
                                  if (allEdges.hasOwnProperty(each)) {
                                      for (let eachProp in allEdges[each]) {
                                          if (allEdges[each].hasOwnProperty(eachProp)) {
                                              propControl.addOption({id: eachProp, title: eachProp})
                                          }
                                      }
                                  }
                              }
                          }
                          else if (arguments[0] === 'node') {
                              for (let each in allNodes) {
                                  if (allNodes.hasOwnProperty(each)) {
                                      for (let eachProp in allNodes[each]) {
                                          if (allNodes[each].hasOwnProperty(eachProp)
                                              && (eachProp !== 'hidden' && eachProp !== 'savedLabel'
                                                  && eachProp !== 'hiddenLabel')) {
                                              propControl.addOption({id: eachProp, title: eachProp})

                                          }
                                      }
                                  }
                              }
                          }
                      }
                  };

                  let itemControl = new TomSelect("#select-item",{
                      create: false,
                      sortField:{
                          field: "text",
                          direction: "asc"
                      },
                      onItemAdd: addProperties()
                  });

                  function clearFilter(reset) {
                      // utility function to clear all the selected filter options
                      // if reset is set to true, the existing filter will be removed
                      // else, only the dropdown options are cleared
                      propControl.clear();
                      propControl.clearOptions();
                      valueControl.clear();
                      valueControl.clearOptions();
                      filter = {
                          item : '',
                          property : '',
                          value : []
                      }
                      if (reset) {
                          itemControl.clear();
                          filterHighlight({nodes: []})
                      }
                  }

                  function updateFilter(value, key) {
                      // key could be 'item' or 'property' and value is as selected in dropdown
                      filter[key] = value
                  }

              

              // This method is responsible for drawing the graph, returns the drawn network
              function drawGraph() {
                  var container = document.getElementById('mynetwork');

                  

                  // parsing and collecting nodes and edges from the python
                  nodes = new vis.DataSet([{"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Ingesta", "id": "RM-001", "label": "RM-001", "level": 0, "shape": "dot", "size": 35, "title": "RM-001: Registro de brokers"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Ingesta", "id": "RM-002", "label": "RM-002", "level": 1, "shape": "dot", "size": 35, "title": "RM-002: Validaci\u00f3n de URL"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Ingesta", "id": "RM-003", "label": "RM-003", "level": 2, "shape": "dot", "size": 25, "title": "RM-003: Pol\u00edticas de acceso por dominio (robots/ToS)"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Ingesta", "id": "RM-004", "label": "RM-004", "level": 1, "shape": "dot", "size": 35, "title": "RM-004: Scheduler de crawls"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Ingesta", "id": "RM-005", "label": "RM-005", "level": 1, "shape": "dot", "size": 35, "title": "RM-005: Rate limiting, retries y circuit breaker"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Extracci\u00f3n", "id": "RM-006", "label": "RM-006", "level": 2, "shape": "dot", "size": 35, "title": "RM-006: Parser HTML por dominio"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Extracci\u00f3n", "id": "RM-007", "label": "RM-007", "level": 1, "shape": "dot", "size": 25, "title": "RM-007: Soporte JSON/API cuando exista"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Extracci\u00f3n", "id": "RM-008", "label": "RM-008", "level": 2, "shape": "dot", "size": 18, "title": "RM-008: Descarga de adjuntos relevantes"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Modelo de datos", "id": "RM-009", "label": "RM-009", "level": 1, "shape": "dot", "size": 35, "title": "RM-009: Almacenamiento de datos crudos versionados"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Modelo de datos", "id": "RM-010", "label": "RM-010", "level": 1, "shape": "dot", "size": 35, "title": "RM-010: Entidades normalizadas y snapshots"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Transformaci\u00f3n", "id": "RM-011", "label": "RM-011", "level": 1, "shape": "dot", "size": 35, "title": "RM-011: Reglas de mapeo configurables"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Transformaci\u00f3n", "id": "RM-012", "label": "RM-012", "level": 1, "shape": "dot", "size": 35, "title": "RM-012: Limpieza y estandarizaci\u00f3n de datos"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "M\u00e9tricas", "id": "RM-013", "label": "RM-013", "level": 1, "shape": "dot", "size": 35, "title": "RM-013: Cat\u00e1logo de definiciones de m\u00e9tricas"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "M\u00e9tricas", "id": "RM-014", "label": "RM-014", "level": 1, "shape": "dot", "size": 35, "title": "RM-014: C\u00e1lculo de m\u00e9tricas core"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "M\u00e9tricas", "id": "RM-015", "label": "RM-015", "level": 1, "shape": "dot", "size": 25, "title": "RM-015: M\u00e9tricas de costos/fees"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "M\u00e9tricas", "id": "RM-016", "label": "RM-016", "level": 2, "shape": "dot", "size": 18, "title": "RM-016: Flags de riesgo/compliance basados en reglas"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "M\u00e9tricas", "id": "RM-017", "label": "RM-017", "level": 1, "shape": "dot", "size": 35, "title": "RM-017: Benchmarks, percentiles y rankings"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Calidad de datos", "id": "RM-018", "label": "RM-018", "level": 2, "shape": "dot", "size": 35, "title": "RM-018: Score de completitud"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Calidad de datos", "id": "RM-019", "label": "RM-019", "level": 3, "shape": "dot", "size": 25, "title": "RM-019: Detecci\u00f3n de anomal\u00edas"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Auditabilidad", "id": "RM-020", "label": "RM-020", "level": 2, "shape": "dot", "size": 35, "title": "RM-020: Lineage de m\u00e9tricas a raw data"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Validaci\u00f3n de algoritmo", "id": "RM-021", "label": "RM-021", "level": 1, "shape": "dot", "size": 35, "title": "RM-021: Contrato de integraci\u00f3n del algoritmo"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Validaci\u00f3n de algoritmo", "id": "RM-022", "label": "RM-022", "level": 1, "shape": "dot", "size": 35, "title": "RM-022: Constructor de datasets (feature matrix)"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Validaci\u00f3n de algoritmo", "id": "RM-023", "label": "RM-023", "level": 2, "shape": "dot", "size": 35, "title": "RM-023: Runner de backtests/experimentos"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Validaci\u00f3n de algoritmo", "id": "RM-024", "label": "RM-024", "level": 2, "shape": "dot", "size": 35, "title": "RM-024: M\u00e9tricas de evaluaci\u00f3n y scorecards"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Validaci\u00f3n de algoritmo", "id": "RM-025", "label": "RM-025", "level": 2, "shape": "dot", "size": 25, "title": "RM-025: Diagn\u00f3sticos y sensibilidad"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Validaci\u00f3n de algoritmo", "id": "RM-026", "label": "RM-026", "level": 1, "shape": "dot", "size": 25, "title": "RM-026: What-if y parameter sweeps"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Reportes", "id": "RM-027", "label": "RM-027", "level": 3, "shape": "dot", "size": 35, "title": "RM-027: Plantillas y generaci\u00f3n de reportes"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Reportes", "id": "RM-028", "label": "RM-028", "level": 3, "shape": "dot", "size": 18, "title": "RM-028: Distribuci\u00f3n programada"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Dashboard", "id": "RM-029", "label": "RM-029", "level": 5, "shape": "dot", "size": 35, "title": "RM-029: Vistas core del dashboard"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Dashboard", "id": "RM-030", "label": "RM-030", "level": 4, "shape": "dot", "size": 35, "title": "RM-030: Comparaciones y rankings"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Dashboard", "id": "RM-031", "label": "RM-031", "level": 3, "shape": "dot", "size": 25, "title": "RM-031: Explorador de runs/experimentos"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Exportaci\u00f3n", "id": "RM-032", "label": "RM-032", "level": 3, "shape": "dot", "size": 35, "title": "RM-032: Exports de datos y resultados"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Seguridad", "id": "RM-033", "label": "RM-033", "level": 0, "shape": "dot", "size": 35, "title": "RM-033: Autenticaci\u00f3n"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Seguridad", "id": "RM-034", "label": "RM-034", "level": 1, "shape": "dot", "size": 35, "title": "RM-034: Autorizaci\u00f3n y roles (RBAC)"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Seguridad", "id": "RM-035", "label": "RM-035", "level": 1, "shape": "dot", "size": 35, "title": "RM-035: Gesti\u00f3n de secretos"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Observabilidad", "id": "RM-036", "label": "RM-036", "level": 2, "shape": "dot", "size": 35, "title": "RM-036: Logging estructurado con correlaci\u00f3n"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Observabilidad", "id": "RM-037", "label": "RM-037", "level": 1, "shape": "dot", "size": 25, "title": "RM-037: M\u00e9tricas y alertas operativas"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Performance", "id": "RM-038", "label": "RM-038", "level": 2, "shape": "dot", "size": 35, "title": "RM-038: Throughput del pipeline"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Performance", "id": "RM-039", "label": "RM-039", "level": 2, "shape": "dot", "size": 25, "title": "RM-039: Responsividad del dashboard"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Reproducibilidad", "id": "RM-040", "label": "RM-040", "level": 5, "shape": "dot", "size": 35, "title": "RM-040: Versionado end-to-end de componentes"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Testing", "id": "RM-041", "label": "RM-041", "level": 3, "shape": "dot", "size": 35, "title": "RM-041: Suite de unit/integration/E2E"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Testing", "id": "RM-042", "label": "RM-042", "level": 3, "shape": "dot", "size": 35, "title": "RM-042: Data contract tests (schemas)"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "DevOps", "id": "RM-043", "label": "RM-043", "level": 2, "shape": "dot", "size": 35, "title": "RM-043: CI/CD + migraciones + rollback"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Gobernanza de datos", "id": "RM-044", "label": "RM-044", "level": 3, "shape": "dot", "size": 25, "title": "RM-044: Retenci\u00f3n y archivado"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Gobernanza", "id": "RM-045", "label": "RM-045", "level": 1, "shape": "dot", "size": 35, "title": "RM-045: Bit\u00e1cora de auditor\u00eda de acciones cr\u00edticas"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "UX", "id": "RM-046", "label": "RM-046", "level": 3, "shape": "dot", "size": 25, "title": "RM-046: Transparencia de errores y remediaci\u00f3n"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Privacidad", "id": "RM-047", "label": "RM-047", "level": 2, "shape": "dot", "size": 18, "title": "RM-047: Minimizaci\u00f3n y redacci\u00f3n de datos"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Documentaci\u00f3n", "id": "RM-048", "label": "RM-048", "level": 1, "shape": "dot", "size": 35, "title": "RM-048: Docs t\u00e9cnicas y operativas"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Extensibilidad", "id": "RM-049", "label": "RM-049", "level": 3, "shape": "dot", "size": 25, "title": "RM-049: Onboarding de nuevo dominio/fuente"}, {"borderWidth": 2, "font": {"color": "#ffffff"}, "group": "Entregables", "id": "RM-050", "label": "RM-050", "level": 49, "shape": "dot", "size": 35, "title": "RM-050: Criterio de aceptaci\u00f3n del MVP"}]);
                  edges = new vis.DataSet([{"arrows": "to", "from": "RM-001", "to": "RM-002"}, {"arrows": "to", "from": "RM-001", "to": "RM-003"}, {"arrows": "to", "from": "RM-001", "to": "RM-004"}, {"arrows": "to", "from": "RM-001", "to": "RM-050"}, {"arrows": "to", "from": "RM-002", "to": "RM-003"}, {"arrows": "to", "from": "RM-002", "to": "RM-050"}, {"arrows": "to", "from": "RM-003", "to": "RM-005"}, {"arrows": "to", "from": "RM-003", "to": "RM-008"}, {"arrows": "to", "from": "RM-003", "to": "RM-050"}, {"arrows": "to", "from": "RM-004", "to": "RM-006"}, {"arrows": "to", "from": "RM-004", "to": "RM-028"}, {"arrows": "to", "from": "RM-004", "to": "RM-036"}, {"arrows": "to", "from": "RM-004", "to": "RM-038"}, {"arrows": "to", "from": "RM-004", "to": "RM-050"}, {"arrows": "to", "from": "RM-005", "to": "RM-006"}, {"arrows": "to", "from": "RM-005", "to": "RM-038"}, {"arrows": "to", "from": "RM-005", "to": "RM-050"}, {"arrows": "to", "from": "RM-006", "to": "RM-007"}, {"arrows": "to", "from": "RM-006", "to": "RM-008"}, {"arrows": "to", "from": "RM-006", "to": "RM-009"}, {"arrows": "to", "from": "RM-006", "to": "RM-041"}, {"arrows": "to", "from": "RM-006", "to": "RM-049"}, {"arrows": "to", "from": "RM-006", "to": "RM-050"}, {"arrows": "to", "from": "RM-007", "to": "RM-050"}, {"arrows": "to", "from": "RM-008", "to": "RM-050"}, {"arrows": "to", "from": "RM-009", "to": "RM-010"}, {"arrows": "to", "from": "RM-009", "to": "RM-019"}, {"arrows": "to", "from": "RM-009", "to": "RM-020"}, {"arrows": "to", "from": "RM-009", "to": "RM-040"}, {"arrows": "to", "from": "RM-009", "to": "RM-044"}, {"arrows": "to", "from": "RM-009", "to": "RM-050"}, {"arrows": "to", "from": "RM-010", "to": "RM-011"}, {"arrows": "to", "from": "RM-010", "to": "RM-013"}, {"arrows": "to", "from": "RM-010", "to": "RM-022"}, {"arrows": "to", "from": "RM-010", "to": "RM-032"}, {"arrows": "to", "from": "RM-010", "to": "RM-042"}, {"arrows": "to", "from": "RM-010", "to": "RM-050"}, {"arrows": "to", "from": "RM-011", "to": "RM-012"}, {"arrows": "to", "from": "RM-011", "to": "RM-019"}, {"arrows": "to", "from": "RM-011", "to": "RM-040"}, {"arrows": "to", "from": "RM-011", "to": "RM-049"}, {"arrows": "to", "from": "RM-011", "to": "RM-050"}, {"arrows": "to", "from": "RM-012", "to": "RM-050"}, {"arrows": "to", "from": "RM-013", "to": "RM-014"}, {"arrows": "to", "from": "RM-013", "to": "RM-015"}, {"arrows": "to", "from": "RM-013", "to": "RM-016"}, {"arrows": "to", "from": "RM-013", "to": "RM-018"}, {"arrows": "to", "from": "RM-013", "to": "RM-020"}, {"arrows": "to", "from": "RM-013", "to": "RM-024"}, {"arrows": "to", "from": "RM-013", "to": "RM-032"}, {"arrows": "to", "from": "RM-013", "to": "RM-040"}, {"arrows": "to", "from": "RM-013", "to": "RM-041"}, {"arrows": "to", "from": "RM-013", "to": "RM-050"}, {"arrows": "to", "from": "RM-014", "to": "RM-017"}, {"arrows": "to", "from": "RM-014", "to": "RM-018"}, {"arrows": "to", "from": "RM-014", "to": "RM-019"}, {"arrows": "to", "from": "RM-014", "to": "RM-027"}, {"arrows": "to", "from": "RM-014", "to": "RM-029"}, {"arrows": "to", "from": "RM-014", "to": "RM-050"}, {"arrows": "to", "from": "RM-015", "to": "RM-050"}, {"arrows": "to", "from": "RM-016", "to": "RM-050"}, {"arrows": "to", "from": "RM-017", "to": "RM-029"}, {"arrows": "to", "from": "RM-017", "to": "RM-030"}, {"arrows": "to", "from": "RM-017", "to": "RM-039"}, {"arrows": "to", "from": "RM-017", "to": "RM-050"}, {"arrows": "to", "from": "RM-018", "to": "RM-030"}, {"arrows": "to", "from": "RM-018", "to": "RM-050"}, {"arrows": "to", "from": "RM-019", "to": "RM-030"}, {"arrows": "to", "from": "RM-019", "to": "RM-046"}, {"arrows": "to", "from": "RM-019", "to": "RM-050"}, {"arrows": "to", "from": "RM-020", "to": "RM-016"}, {"arrows": "to", "from": "RM-020", "to": "RM-027"}, {"arrows": "to", "from": "RM-020", "to": "RM-029"}, {"arrows": "to", "from": "RM-020", "to": "RM-046"}, {"arrows": "to", "from": "RM-020", "to": "RM-050"}, {"arrows": "to", "from": "RM-021", "to": "RM-023"}, {"arrows": "to", "from": "RM-021", "to": "RM-040"}, {"arrows": "to", "from": "RM-021", "to": "RM-042"}, {"arrows": "to", "from": "RM-021", "to": "RM-050"}, {"arrows": "to", "from": "RM-022", "to": "RM-021"}, {"arrows": "to", "from": "RM-022", "to": "RM-023"}, {"arrows": "to", "from": "RM-022", "to": "RM-040"}, {"arrows": "to", "from": "RM-022", "to": "RM-042"}, {"arrows": "to", "from": "RM-022", "to": "RM-050"}, {"arrows": "to", "from": "RM-023", "to": "RM-024"}, {"arrows": "to", "from": "RM-023", "to": "RM-025"}, {"arrows": "to", "from": "RM-023", "to": "RM-026"}, {"arrows": "to", "from": "RM-023", "to": "RM-031"}, {"arrows": "to", "from": "RM-023", "to": "RM-036"}, {"arrows": "to", "from": "RM-023", "to": "RM-041"}, {"arrows": "to", "from": "RM-023", "to": "RM-044"}, {"arrows": "to", "from": "RM-023", "to": "RM-050"}, {"arrows": "to", "from": "RM-024", "to": "RM-025"}, {"arrows": "to", "from": "RM-024", "to": "RM-027"}, {"arrows": "to", "from": "RM-024", "to": "RM-031"}, {"arrows": "to", "from": "RM-024", "to": "RM-050"}, {"arrows": "to", "from": "RM-025", "to": "RM-050"}, {"arrows": "to", "from": "RM-026", "to": "RM-050"}, {"arrows": "to", "from": "RM-027", "to": "RM-028"}, {"arrows": "to", "from": "RM-027", "to": "RM-044"}, {"arrows": "to", "from": "RM-027", "to": "RM-050"}, {"arrows": "to", "from": "RM-028", "to": "RM-050"}, {"arrows": "to", "from": "RM-029", "to": "RM-039"}, {"arrows": "to", "from": "RM-029", "to": "RM-050"}, {"arrows": "to", "from": "RM-030", "to": "RM-050"}, {"arrows": "to", "from": "RM-031", "to": "RM-050"}, {"arrows": "to", "from": "RM-032", "to": "RM-030"}, {"arrows": "to", "from": "RM-032", "to": "RM-047"}, {"arrows": "to", "from": "RM-032", "to": "RM-050"}, {"arrows": "to", "from": "RM-033", "to": "RM-029"}, {"arrows": "to", "from": "RM-033", "to": "RM-034"}, {"arrows": "to", "from": "RM-033", "to": "RM-050"}, {"arrows": "to", "from": "RM-034", "to": "RM-028"}, {"arrows": "to", "from": "RM-034", "to": "RM-029"}, {"arrows": "to", "from": "RM-034", "to": "RM-031"}, {"arrows": "to", "from": "RM-034", "to": "RM-032"}, {"arrows": "to", "from": "RM-034", "to": "RM-045"}, {"arrows": "to", "from": "RM-034", "to": "RM-050"}, {"arrows": "to", "from": "RM-035", "to": "RM-043"}, {"arrows": "to", "from": "RM-035", "to": "RM-050"}, {"arrows": "to", "from": "RM-036", "to": "RM-037"}, {"arrows": "to", "from": "RM-036", "to": "RM-046"}, {"arrows": "to", "from": "RM-036", "to": "RM-047"}, {"arrows": "to", "from": "RM-036", "to": "RM-050"}, {"arrows": "to", "from": "RM-037", "to": "RM-050"}, {"arrows": "to", "from": "RM-038", "to": "RM-050"}, {"arrows": "to", "from": "RM-039", "to": "RM-050"}, {"arrows": "to", "from": "RM-040", "to": "RM-050"}, {"arrows": "to", "from": "RM-041", "to": "RM-043"}, {"arrows": "to", "from": "RM-041", "to": "RM-049"}, {"arrows": "to", "from": "RM-041", "to": "RM-050"}, {"arrows": "to", "from": "RM-042", "to": "RM-050"}, {"arrows": "to", "from": "RM-043", "to": "RM-035"}, {"arrows": "to", "from": "RM-043", "to": "RM-048"}, {"arrows": "to", "from": "RM-043", "to": "RM-050"}, {"arrows": "to", "from": "RM-044", "to": "RM-050"}, {"arrows": "to", "from": "RM-045", "to": "RM-050"}, {"arrows": "to", "from": "RM-046", "to": "RM-050"}, {"arrows": "to", "from": "RM-047", "to": "RM-050"}, {"arrows": "to", "from": "RM-048", "to": "RM-050"}, {"arrows": "to", "from": "RM-049", "to": "RM-050"}]);

                  nodeColors = {};
                  allNodes = nodes.get({ returnType: "Object" });
                  for (nodeId in allNodes) {
                    nodeColors[nodeId] = allNodes[nodeId].color;
                  }
                  allEdges = edges.get({ returnType: "Object" });
                  // adding nodes and edges to the graph
                  data = {nodes: nodes, edges: edges};

                  var options = {"nodes": {"font": {"size": 14, "face": "arial", "strokeWidth": 3, "strokeColor": "#1a1a2e"}, "borderWidth": 2, "borderWidthSelected": 4, "shadow": {"enabled": true, "color": "rgba(0,0,0,0.5)", "size": 10, "x": 3, "y": 3}}, "edges": {"color": {"color": "#4a4a6a", "highlight": "#00ff88", "hover": "#00ff88"}, "arrows": {"to": {"enabled": true, "scaleFactor": 0.8}}, "smooth": {"enabled": true, "type": "curvedCW", "roundness": 0.2}, "width": 1.5, "selectionWidth": 3}, "physics": {"enabled": true, "solver": "forceAtlas2Based", "forceAtlas2Based": {"gravitationalConstant": -80, "centralGravity": 0.01, "springLength": 150, "springConstant": 0.08, "damping": 0.4, "avoidOverlap": 0.8}, "stabilization": {"enabled": true, "iterations": 200, "updateInterval": 25}}, "interaction": {"hover": true, "hoverConnectedEdges": true, "selectConnectedEdges": true, "multiselect": true, "dragNodes": true, "dragView": true, "zoomView": true, "navigationButtons": true, "keyboard": {"enabled": true, "speed": {"x": 10, "y": 10, "zoom": 0.1}}, "tooltipDelay": 100}, "configure": {"enabled": false}};

                  


                  

                  network = new vis.Network(container, data, options);

                  

                  
                    network.on("selectNode", neighbourhoodHighlight);
                  

                  


                  

                  return network;

              }
              drawGraph();
        </script>
    
    <script>
        const nodeData = {"RM-001": {"area": "Ingesta", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Registro de brokers", "requisito": "El sistema deber\u00e1 permitir cargar y administrar una lista configurable de N brokers con 1..N URLs de perfil por broker y metadatos (broker_id, nombre, regi\u00f3n, etiquetas/estrategia). Debe soportar importaci\u00f3n masiva (CSV) y edici\u00f3n incremental.", "owner": "Backend", "roles": "Admin; Sistema", "estatus": "BACKLOG", "dependencias": "\u2014", "in_degree": 0, "out_degree": 4}, "RM-002": {"area": "Ingesta", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Validaci\u00f3n de URL", "requisito": "Antes de ejecutar extracci\u00f3n, el sistema deber\u00e1 validar cada URL (sintaxis, esquema, dominio permitido, alcanzabilidad HTTP/DNS) y persistir el resultado con c\u00f3digo de error y pol\u00edtica de reintento.", "owner": "Backend", "roles": "Sistema; Admin", "estatus": "BACKLOG", "dependencias": "RM-001", "in_degree": 1, "out_degree": 2}, "RM-003": {"area": "Ingesta", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Pol\u00edticas de acceso por dominio (robots/ToS)", "requisito": "El sistema deber\u00e1 registrar pol\u00edticas por dominio (robots.txt snapshot, rate limit, notas ToS internas) y hacer cumplir dichas pol\u00edticas durante la extracci\u00f3n. Debe permitir bloquear dominios o pausar scraping.", "owner": "Backend/DevOps", "roles": "Admin; DevOps; Sistema", "estatus": "BACKLOG", "dependencias": "RM-001,RM-002", "in_degree": 2, "out_degree": 3}, "RM-004": {"area": "Ingesta", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Scheduler de crawls", "requisito": "El sistema deber\u00e1 soportar ejecuci\u00f3n programada (horario configurable por proyecto y/o por broker) y refresh on-demand por broker, generando jobs con trazabilidad (run_id, broker_id, created_by).", "owner": "Backend/DevOps", "roles": "Admin; Analista; Sistema", "estatus": "BACKLOG", "dependencias": "RM-001", "in_degree": 1, "out_degree": 5}, "RM-005": {"area": "Ingesta", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Rate limiting, retries y circuit breaker", "requisito": "El sistema deber\u00e1 implementar rate limiting por dominio, retries con exponential backoff y circuit breaker ante fallas repetidas. Debe registrar m\u00e9tricas de requests y errores.", "owner": "Backend/DevOps", "roles": "Sistema; DevOps", "estatus": "BACKLOG", "dependencias": "RM-003", "in_degree": 1, "out_degree": 3}, "RM-006": {"area": "Extracci\u00f3n", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Parser HTML por dominio", "requisito": "El sistema deber\u00e1 extraer datos crudos desde HTML usando adaptadores por dominio (selectores/mapeos) mantenibles y testeables, versionando el parser.", "owner": "Backend", "roles": "Sistema; Backend", "estatus": "BACKLOG", "dependencias": "RM-004,RM-005", "in_degree": 2, "out_degree": 6}, "RM-007": {"area": "Extracci\u00f3n", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Soporte JSON/API cuando exista", "requisito": "Si el perfil expone datos v\u00eda JSON/API (directo o embebido), el adaptador deber\u00e1 preferir esa fuente por estabilidad y registrar el endpoint utilizado.", "owner": "Backend", "roles": "Sistema; Backend", "estatus": "BACKLOG", "dependencias": "RM-006", "in_degree": 1, "out_degree": 1}, "RM-008": {"area": "Extracci\u00f3n", "prioridad": "Baja (P2)", "version": "v0.3", "funcionalidad": "Descarga de adjuntos relevantes", "requisito": "El sistema deber\u00e1 detectar y descargar adjuntos/links (PDF u otros permitidos) asociados al perfil cuando est\u00e9n presentes y permitidos por pol\u00edtica, guardando checksum y metadatos.", "owner": "Backend", "roles": "Sistema; Backend", "estatus": "BACKLOG", "dependencias": "RM-003,RM-006", "in_degree": 2, "out_degree": 1}, "RM-009": {"area": "Modelo de datos", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Almacenamiento de datos crudos versionados", "requisito": "El sistema deber\u00e1 guardar registros crudos inmutables con URL fuente, timestamp, parser_version, content_hash y payload (JSON). No debe sobrescribir datos crudos.", "owner": "Backend", "roles": "Sistema; Backend", "estatus": "BACKLOG", "dependencias": "RM-006", "in_degree": 1, "out_degree": 6}, "RM-010": {"area": "Modelo de datos", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Entidades normalizadas y snapshots", "requisito": "El sistema deber\u00e1 normalizar datos crudos a entidades n\u00facleo (Broker, ProfileSnapshot, MetricDefinition, MetricValue, Run, Experiment) y soportar snapshots temporalmente indexados.", "owner": "Backend", "roles": "Backend; Quant; Sistema", "estatus": "BACKLOG", "dependencias": "RM-009", "in_degree": 1, "out_degree": 6}, "RM-011": {"area": "Transformaci\u00f3n", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Reglas de mapeo configurables", "requisito": "El sistema deber\u00e1 permitir definir reglas de mapeo (por dominio) desde campos crudos a campos normalizados, con versionado y capacidad de rollback. Idealmente sin despliegue de c\u00f3digo para cambios menores.", "owner": "Backend", "roles": "Admin; Backend; Quant", "estatus": "BACKLOG", "dependencias": "RM-010", "in_degree": 1, "out_degree": 5}, "RM-012": {"area": "Transformaci\u00f3n", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Limpieza y estandarizaci\u00f3n de datos", "requisito": "El sistema deber\u00e1 limpiar y estandarizar formatos (fechas, divisas, porcentajes, locales) a formatos can\u00f3nicos y registrar errores de parseo por campo.", "owner": "Backend", "roles": "Backend; Sistema", "estatus": "BACKLOG", "dependencias": "RM-011", "in_degree": 1, "out_degree": 1}, "RM-013": {"area": "M\u00e9tricas", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Cat\u00e1logo de definiciones de m\u00e9tricas", "requisito": "El sistema deber\u00e1 mantener un registro versionado de m\u00e9tricas (nombre, f\u00f3rmula/algoritmo, insumos requeridos, unidad, rango v\u00e1lido, y constraints). Ser\u00e1 la fuente \u00fanica para c\u00f3mputo y reporteo.", "owner": "Backend/Quant", "roles": "Quant; Backend; Admin", "estatus": "BACKLOG", "dependencias": "RM-010", "in_degree": 1, "out_degree": 10}, "RM-014": {"area": "M\u00e9tricas", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "C\u00e1lculo de m\u00e9tricas core", "requisito": "El sistema deber\u00e1 calcular m\u00e9tricas base por broker y por periodo (p.ej. rendimiento, volatilidad, drawdown, win-rate) a partir de los datos disponibles, y manejar expl\u00edcitamente el caso de 'datos insuficientes'.", "owner": "Quant", "roles": "Quant; Sistema", "estatus": "BACKLOG", "dependencias": "RM-013", "in_degree": 1, "out_degree": 6}, "RM-015": {"area": "M\u00e9tricas", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "M\u00e9tricas de costos/fees", "requisito": "El sistema deber\u00e1 calcular m\u00e9tricas relacionadas a costos/fees/spread cuando existan, documentando supuestos y anex\u00e1ndolos a reportes y exportaciones.", "owner": "Quant", "roles": "Quant; Analista", "estatus": "BACKLOG", "dependencias": "RM-013", "in_degree": 1, "out_degree": 1}, "RM-016": {"area": "M\u00e9tricas", "prioridad": "Baja (P2)", "version": "v0.3", "funcionalidad": "Flags de riesgo/compliance basados en reglas", "requisito": "El sistema deber\u00e1 evaluar reglas determin\u00edsticas para generar banderas (p.ej. disclosures faltantes, claims an\u00f3malos) y adjuntar evidencia (campo crudo + snapshot) para cada flag.", "owner": "Quant/Backend", "roles": "Quant; Analista; Admin", "estatus": "BACKLOG", "dependencias": "RM-013,RM-020", "in_degree": 2, "out_degree": 1}, "RM-017": {"area": "M\u00e9tricas", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Benchmarks, percentiles y rankings", "requisito": "El sistema deber\u00e1 generar agregados cross-broker (percentiles, rankings, peer groups) con definiciones versionadas de peer group y desempate determin\u00edstico.", "owner": "Quant", "roles": "Analista; Viewer", "estatus": "BACKLOG", "dependencias": "RM-014", "in_degree": 1, "out_degree": 4}, "RM-018": {"area": "Calidad de datos", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Score de completitud", "requisito": "El sistema deber\u00e1 calcular un score de completitud por broker y por m\u00e9trica en [0,1], basado en disponibilidad de insumos y cobertura temporal. Debe mostrarse en dashboard y reportes.", "owner": "Backend/Quant", "roles": "Analista; Viewer", "estatus": "BACKLOG", "dependencias": "RM-013,RM-014", "in_degree": 2, "out_degree": 2}, "RM-019": {"area": "Calidad de datos", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Detecci\u00f3n de anomal\u00edas", "requisito": "El sistema deber\u00e1 detectar anomal\u00edas (saltos bruscos de m\u00e9tricas, huecos temporales, cambios de parser/mapping) y etiquetar resultados afectados; debe permitir filtrar anomal\u00edas en validaci\u00f3n del algoritmo.", "owner": "Quant/Backend", "roles": "Analista; Quant; DevOps", "estatus": "BACKLOG", "dependencias": "RM-014,RM-011,RM-009", "in_degree": 3, "out_degree": 3}, "RM-020": {"area": "Auditabilidad", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Lineage de m\u00e9tricas a raw data", "requisito": "El sistema deber\u00e1 proveer trazabilidad desde cualquier valor de m\u00e9trica/ranking/reporte hasta los raw_records y transformaciones usadas (parser_version, mapping_version, metric_definition_version).", "owner": "Backend", "roles": "Analista; Admin", "estatus": "BACKLOG", "dependencias": "RM-009,RM-013", "in_degree": 2, "out_degree": 5}, "RM-021": {"area": "Validaci\u00f3n de algoritmo", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Contrato de integraci\u00f3n del algoritmo", "requisito": "El sistema deber\u00e1 integrar el algoritmo de optimizaci\u00f3n del cliente mediante una interfaz definida (CLI/API/librer\u00eda) con versionado (algorithm_build_id) y entradas/salidas determin\u00edsticas o con tolerancia definida.", "owner": "Backend/Quant", "roles": "Quant; Backend; DevOps", "estatus": "BACKLOG", "dependencias": "RM-022", "in_degree": 1, "out_degree": 4}, "RM-022": {"area": "Validaci\u00f3n de algoritmo", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Constructor de datasets (feature matrix)", "requisito": "El sistema deber\u00e1 construir datasets de validaci\u00f3n desde datos normalizados (features, targets/labels si aplica) con ventanas temporales expl\u00edcitas y metadatos (schema_version, broker_set, feature_list).", "owner": "Quant/Backend", "roles": "Quant; Analista", "estatus": "BACKLOG", "dependencias": "RM-010", "in_degree": 1, "out_degree": 5}, "RM-023": {"area": "Validaci\u00f3n de algoritmo", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Runner de backtests/experimentos", "requisito": "El sistema deber\u00e1 ejecutar runs de validaci\u00f3n sobre datasets seleccionados, guardando par\u00e1metros, logs, outputs, y m\u00e9tricas de ejecuci\u00f3n. Debe soportar tipos de run (train/validate/test) si aplica.", "owner": "Quant/Backend", "roles": "Quant; Analista", "estatus": "BACKLOG", "dependencias": "RM-021,RM-022", "in_degree": 2, "out_degree": 8}, "RM-024": {"area": "Validaci\u00f3n de algoritmo", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "M\u00e9tricas de evaluaci\u00f3n y scorecards", "requisito": "El sistema deber\u00e1 calcular m\u00e9tricas de evaluaci\u00f3n (error, estabilidad, violaciones de constraints, uplift vs baseline) seg\u00fan el objetivo del cliente, con thresholds configurables para pass/fail.", "owner": "Quant", "roles": "Quant; Analista; Viewer", "estatus": "BACKLOG", "dependencias": "RM-023,RM-013", "in_degree": 2, "out_degree": 4}, "RM-025": {"area": "Validaci\u00f3n de algoritmo", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Diagn\u00f3sticos y sensibilidad", "requisito": "El sistema deber\u00e1 generar diagn\u00f3sticos para runs (p.ej. an\u00e1lisis de fallos, frecuencia de constraints activas, ablation/feature importance si aplica) y exportarlos en reporte t\u00e9cnico.", "owner": "Quant", "roles": "Quant; Analista", "estatus": "BACKLOG", "dependencias": "RM-023,RM-024", "in_degree": 2, "out_degree": 1}, "RM-026": {"area": "Validaci\u00f3n de algoritmo", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "What-if y parameter sweeps", "requisito": "El sistema deber\u00e1 permitir ejecutar batch de escenarios (fees \u00b1x, imputaci\u00f3n, distintos thresholds) y comparar resultados en una tabla/visualizaci\u00f3n \u00fanica.", "owner": "Quant/Backend", "roles": "Quant; Analista", "estatus": "BACKLOG", "dependencias": "RM-023", "in_degree": 1, "out_degree": 1}, "RM-027": {"area": "Reportes", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Plantillas y generaci\u00f3n de reportes", "requisito": "El sistema deber\u00e1 generar reportes (HTML/PDF) a partir de plantillas con secciones: overview brokers, tablas de m\u00e9tricas, scorecards de validaci\u00f3n, anomal\u00edas y appendix de metodolog\u00eda + versiones.", "owner": "Backend", "roles": "Analista; Viewer; Admin", "estatus": "BACKLOG", "dependencias": "RM-014,RM-024,RM-020", "in_degree": 3, "out_degree": 3}, "RM-028": {"area": "Reportes", "prioridad": "Baja (P2)", "version": "v0.3", "funcionalidad": "Distribuci\u00f3n programada", "requisito": "El sistema deber\u00e1 soportar generaci\u00f3n y distribuci\u00f3n programada de reportes (link seguro, email y/o webhook), con reintentos y alertas de falla.", "owner": "Backend/DevOps", "roles": "Admin; DevOps; Sistema", "estatus": "BACKLOG", "dependencias": "RM-027,RM-004,RM-034", "in_degree": 3, "out_degree": 1}, "RM-029": {"area": "Dashboard", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Vistas core del dashboard", "requisito": "El sistema deber\u00e1 proveer dashboard con: lista de brokers + filtros, p\u00e1gina detalle broker con charts, y resumen de validaci\u00f3n del algoritmo; debe soportar drill-down a lineage.", "owner": "Frontend", "roles": "Viewer; Analista; Admin", "estatus": "BACKLOG", "dependencias": "RM-014,RM-017,RM-020,RM-033,RM-034", "in_degree": 5, "out_degree": 2}, "RM-030": {"area": "Dashboard", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Comparaciones y rankings", "requisito": "El sistema deber\u00e1 permitir comparaci\u00f3n side-by-side de brokers y tablas de ranking con columnas configurables, ordenamiento y exportaci\u00f3n.", "owner": "Frontend", "roles": "Viewer; Analista", "estatus": "BACKLOG", "dependencias": "RM-017,RM-032,RM-018,RM-019", "in_degree": 4, "out_degree": 1}, "RM-031": {"area": "Dashboard", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Explorador de runs/experimentos", "requisito": "El sistema deber\u00e1 proveer UI para explorar runs (filtros por versi\u00f3n, par\u00e1metros, fecha, estado) y comparar 2+ runs, mostrando diffs y scorecards.", "owner": "Frontend", "roles": "Analista; Quant", "estatus": "BACKLOG", "dependencias": "RM-023,RM-024,RM-034", "in_degree": 3, "out_degree": 1}, "RM-032": {"area": "Exportaci\u00f3n", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Exports de datos y resultados", "requisito": "El sistema deber\u00e1 exportar (CSV/JSON) registro de brokers, m\u00e9tricas y resultados de runs con metadatos de schema y unidades; exports grandes deben ser as\u00edncronos.", "owner": "Backend", "roles": "Analista; Admin", "estatus": "BACKLOG", "dependencias": "RM-010,RM-013,RM-034", "in_degree": 3, "out_degree": 3}, "RM-033": {"area": "Seguridad", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Autenticaci\u00f3n", "requisito": "El sistema deber\u00e1 requerir autenticaci\u00f3n para dashboard, reportes y exports (email/password o SSO/OIDC), con sesiones seguras, CSRF donde aplique y pol\u00edticas de password.", "owner": "Backend/DevOps", "roles": "Admin; Viewer; Analista", "estatus": "BACKLOG", "dependencias": "\u2014", "in_degree": 0, "out_degree": 3}, "RM-034": {"area": "Seguridad", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Autorizaci\u00f3n y roles (RBAC)", "requisito": "El sistema deber\u00e1 implementar RBAC (Admin, Analista, Viewer) controlando: alta/edici\u00f3n brokers, ejecuci\u00f3n runs, exports, cambios de pol\u00edticas y acceso a auditor\u00edas.", "owner": "Backend/Frontend", "roles": "Admin; Analista; Viewer", "estatus": "BACKLOG", "dependencias": "RM-033", "in_degree": 1, "out_degree": 6}, "RM-035": {"area": "Seguridad", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Gesti\u00f3n de secretos", "requisito": "El sistema deber\u00e1 gestionar secretos (API keys, SMTP, webhooks) fuera del repositorio (env/secret manager) y activar detecci\u00f3n de secretos en CI.", "owner": "DevOps", "roles": "DevOps", "estatus": "BACKLOG", "dependencias": "RM-043", "in_degree": 1, "out_degree": 2}, "RM-036": {"area": "Observabilidad", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Logging estructurado con correlaci\u00f3n", "requisito": "El sistema deber\u00e1 emitir logs estructurados (JSON) para ingesta, transformaci\u00f3n, m\u00e9tricas y runs con correlation_id (run_id, broker_id, job_id) y niveles consistentes.", "owner": "DevOps", "roles": "DevOps; Backend", "estatus": "BACKLOG", "dependencias": "RM-004,RM-023", "in_degree": 2, "out_degree": 4}, "RM-037": {"area": "Observabilidad", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "M\u00e9tricas y alertas operativas", "requisito": "El sistema deber\u00e1 exponer m\u00e9tricas (duraci\u00f3n de jobs, tasa de \u00e9xito, errores de scraping, latencia API) y alertas por umbrales (p.ej. fallas >X%, retrasos).", "owner": "DevOps", "roles": "DevOps; Admin", "estatus": "BACKLOG", "dependencias": "RM-036", "in_degree": 1, "out_degree": 1}, "RM-038": {"area": "Performance", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Throughput del pipeline", "requisito": "El sistema deber\u00e1 procesar al menos 100 URLs end-to-end dentro de un SLA configurable (p.ej. <30 min) usando paralelismo sin violar rate limits por dominio.", "owner": "Backend/DevOps", "roles": "DevOps; Backend", "estatus": "BACKLOG", "dependencias": "RM-005,RM-004", "in_degree": 2, "out_degree": 1}, "RM-039": {"area": "Performance", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Responsividad del dashboard", "requisito": "El sistema deber\u00e1 mantener interacciones del dashboard con P95 <2s para consultas t\u00edpicas y <10s para consultas pesadas, mostrando indicador de progreso si aplica.", "owner": "Backend/Frontend", "roles": "Frontend; Backend", "estatus": "BACKLOG", "dependencias": "RM-029,RM-017", "in_degree": 2, "out_degree": 1}, "RM-040": {"area": "Reproducibilidad", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Versionado end-to-end de componentes", "requisito": "El sistema deber\u00e1 versionar y relacionar parsers, mapeos, definiciones de m\u00e9tricas, datasets y builds del algoritmo, y asociarlos a cada run y reporte.", "owner": "Backend/Quant", "roles": "Quant; Backend", "estatus": "BACKLOG", "dependencias": "RM-009,RM-011,RM-013,RM-021,RM-022", "in_degree": 5, "out_degree": 1}, "RM-041": {"area": "Testing", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Suite de unit/integration/E2E", "requisito": "El sistema deber\u00e1 incluir pruebas autom\u00e1ticas para parsers, transformaciones, m\u00e9tricas y runner del algoritmo. Debe usar fixtures grabadas (no depender de sitios live) y seguir enfoque RED/GREEN.", "owner": "All", "roles": "Backend; Quant; Frontend", "estatus": "BACKLOG", "dependencias": "RM-006,RM-013,RM-023", "in_degree": 3, "out_degree": 3}, "RM-042": {"area": "Testing", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Data contract tests (schemas)", "requisito": "El sistema deber\u00e1 aplicar data contracts entre extracci\u00f3n\u2192normalizaci\u00f3n\u2192dataset\u2192algoritmo (schemas versionados) y fallar CI ante cambios rompientes.", "owner": "Backend", "roles": "Backend; Quant", "estatus": "BACKLOG", "dependencias": "RM-010,RM-022,RM-021", "in_degree": 3, "out_degree": 1}, "RM-043": {"area": "DevOps", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "CI/CD + migraciones + rollback", "requisito": "El sistema deber\u00e1 contar con CI/CD para build, tests, deploy y migraciones DB, con promoci\u00f3n de ambientes (dev/stage/prod) y procedimiento de rollback probado.", "owner": "DevOps", "roles": "DevOps", "estatus": "BACKLOG", "dependencias": "RM-041,RM-035", "in_degree": 2, "out_degree": 3}, "RM-044": {"area": "Gobernanza de datos", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Retenci\u00f3n y archivado", "requisito": "El sistema deber\u00e1 definir pol\u00edticas de retenci\u00f3n para raw_records, snapshots, outputs de runs, logs y reportes (purga/archivado) sin dejar referencias hu\u00e9rfanas.", "owner": "Backend/DevOps", "roles": "Admin; DevOps", "estatus": "BACKLOG", "dependencias": "RM-009,RM-023,RM-027", "in_degree": 3, "out_degree": 1}, "RM-045": {"area": "Gobernanza", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Bit\u00e1cora de auditor\u00eda de acciones cr\u00edticas", "requisito": "El sistema deber\u00e1 registrar eventos de auditor\u00eda para: cambios de brokers/URLs, ejecuciones de runs, exports, cambios de roles, cambios de pol\u00edticas, y accesos a reportes/lineage.", "owner": "Backend", "roles": "Admin", "estatus": "BACKLOG", "dependencias": "RM-034", "in_degree": 1, "out_degree": 1}, "RM-046": {"area": "UX", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Transparencia de errores y remediaci\u00f3n", "requisito": "El sistema deber\u00e1 mostrar errores claros y accionables (parser roto, dominio bloqueado, datos insuficientes, run fallido), con pasos sugeridos y links a evidencia (logs/lineage).", "owner": "Frontend", "roles": "Viewer; Analista; Admin", "estatus": "BACKLOG", "dependencias": "RM-019,RM-036,RM-020", "in_degree": 3, "out_degree": 1}, "RM-047": {"area": "Privacidad", "prioridad": "Baja (P2)", "version": "v0.3", "funcionalidad": "Minimizaci\u00f3n y redacci\u00f3n de datos", "requisito": "El sistema deber\u00e1 almacenar s\u00f3lo campos necesarios y permitir redacci\u00f3n/omisi\u00f3n de campos sensibles (si aparecen) en salidas (dash/report/export) seg\u00fan pol\u00edtica.", "owner": "Backend/DevOps", "roles": "Admin; DevOps", "estatus": "BACKLOG", "dependencias": "RM-036,RM-032", "in_degree": 2, "out_degree": 1}, "RM-048": {"area": "Documentaci\u00f3n", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Docs t\u00e9cnicas y operativas", "requisito": "El sistema deber\u00e1 incluir documentaci\u00f3n: setup local, despliegue, runbooks, cat\u00e1logo de m\u00e9tricas, c\u00f3mo agregar un nuevo dominio/adaptador y c\u00f3mo ejecutar validaci\u00f3n del algoritmo.", "owner": "All", "roles": "All", "estatus": "BACKLOG", "dependencias": "RM-043", "in_degree": 1, "out_degree": 1}, "RM-049": {"area": "Extensibilidad", "prioridad": "Media (P1)", "version": "v0.2", "funcionalidad": "Onboarding de nuevo dominio/fuente", "requisito": "El sistema deber\u00e1 ofrecer un proceso est\u00e1ndar (template de adapter + mapping + fixtures + tests) para agregar un nuevo dominio en <=1 d\u00eda para un sitio t\u00edpico.", "owner": "Backend", "roles": "Backend; Quant", "estatus": "BACKLOG", "dependencias": "RM-006,RM-011,RM-041", "in_degree": 3, "out_degree": 1}, "RM-050": {"area": "Entregables", "prioridad": "Alta (P0)", "version": "MVP v0.1", "funcionalidad": "Criterio de aceptaci\u00f3n del MVP", "requisito": "El MVP deber\u00e1 incluir: registro de brokers+URLs, scheduler, extracci\u00f3n+normalizaci\u00f3n, m\u00e9tricas core, dashboard b\u00e1sico, construcci\u00f3n de dataset, ejecuci\u00f3n de runs, scorecard, y generaci\u00f3n de reportes con versionado/lineage.", "owner": "PM/All", "roles": "PM; Admin; Analista", "estatus": "BACKLOG", "dependencias": "RM-001..RM-049", "in_degree": 49, "out_degree": 0}};
        const subgraphData = {"RM-001": {"ancestors": [], "descendants": ["RM-025", "RM-015", "RM-028", "RM-009", "RM-031", "RM-020", "RM-010", "RM-047", "RM-016", "RM-038", "RM-027", "RM-040", "RM-014", "RM-035", "RM-037", "RM-008", "RM-004", "RM-019", "RM-043", "RM-002", "RM-032", "RM-021", "RM-046", "RM-018", "RM-005", "RM-022", "RM-029", "RM-012", "RM-049", "RM-006", "RM-023", "RM-024", "RM-041", "RM-050", "RM-044", "RM-039", "RM-042", "RM-003", "RM-036", "RM-017", "RM-011", "RM-013", "RM-007", "RM-030", "RM-048", "RM-026"]}, "RM-002": {"ancestors": ["RM-001"], "descendants": ["RM-025", "RM-015", "RM-028", "RM-009", "RM-031", "RM-020", "RM-010", "RM-047", "RM-016", "RM-038", "RM-027", "RM-040", "RM-014", "RM-035", "RM-008", "RM-037", "RM-019", "RM-043", "RM-032", "RM-021", "RM-046", "RM-018", "RM-005", "RM-022", "RM-029", "RM-012", "RM-049", "RM-006", "RM-023", "RM-024", "RM-041", "RM-050", "RM-044", "RM-039", "RM-042", "RM-003", "RM-036", "RM-017", "RM-011", "RM-013", "RM-007", "RM-030", "RM-048", "RM-026"]}, "RM-003": {"ancestors": ["RM-001", "RM-002"], "descendants": ["RM-025", "RM-015", "RM-028", "RM-009", "RM-031", "RM-020", "RM-010", "RM-047", "RM-016", "RM-038", "RM-027", "RM-040", "RM-014", "RM-035", "RM-008", "RM-037", "RM-019", "RM-043", "RM-032", "RM-021", "RM-046", "RM-018", "RM-005", "RM-022", "RM-029", "RM-012", "RM-049", "RM-006", "RM-023", "RM-024", "RM-041", "RM-050", "RM-044", "RM-039", "RM-042", "RM-036", "RM-017", "RM-011", "RM-013", "RM-007", "RM-030", "RM-048", "RM-026"]}, "RM-004": {"ancestors": ["RM-001"], "descendants": ["RM-025", "RM-015", "RM-028", "RM-009", "RM-031", "RM-020", "RM-010", "RM-047", "RM-016", "RM-038", "RM-027", "RM-040", "RM-014", "RM-035", "RM-037", "RM-008", "RM-019", "RM-043", "RM-032", "RM-021", "RM-046", "RM-018", "RM-022", "RM-029", "RM-012", "RM-049", "RM-006", "RM-023", "RM-024", "RM-041", "RM-050", "RM-044", "RM-039", "RM-042", "RM-036", "RM-017", "RM-011", "RM-013", "RM-007", "RM-030", "RM-048", "RM-026"]}, "RM-005": {"ancestors": ["RM-003", "RM-001", "RM-002"], "descendants": ["RM-025", "RM-015", "RM-028", "RM-009", "RM-031", "RM-020", "RM-010", "RM-047", "RM-016", "RM-038", "RM-027", "RM-040", "RM-014", "RM-035", "RM-008", "RM-037", "RM-019", "RM-043", "RM-032", "RM-021", "RM-046", "RM-018", "RM-022", "RM-029", "RM-012", "RM-049", "RM-006", "RM-023", "RM-024", "RM-041", "RM-050", "RM-044", "RM-039", "RM-042", "RM-036", "RM-017", "RM-011", "RM-013", "RM-007", "RM-030", "RM-048", "RM-026"]}, "RM-006": {"ancestors": ["RM-002", "RM-003", "RM-001", "RM-005", "RM-004"], "descendants": ["RM-025", "RM-015", "RM-028", "RM-009", "RM-031", "RM-020", "RM-010", "RM-047", "RM-016", "RM-027", "RM-040", "RM-014", "RM-035", "RM-008", "RM-037", "RM-019", "RM-043", "RM-032", "RM-021", "RM-046", "RM-018", "RM-022", "RM-029", "RM-012", "RM-049", "RM-023", "RM-024", "RM-041", "RM-050", "RM-044", "RM-039", "RM-042", "RM-036", "RM-017", "RM-011", "RM-013", "RM-007", "RM-030", "RM-048", "RM-026"]}, "RM-007": {"ancestors": ["RM-002", "RM-003", "RM-006", "RM-001", "RM-005", "RM-004"], "descendants": ["RM-050"]}, "RM-008": {"ancestors": ["RM-002", "RM-003", "RM-001", "RM-006", "RM-005", "RM-004"], "descendants": ["RM-050"]}, "RM-009": {"ancestors": ["RM-002", "RM-003", "RM-006", "RM-001", "RM-005", "RM-004"], "descendants": ["RM-025", "RM-015", "RM-028", "RM-031", "RM-020", "RM-010", "RM-047", "RM-016", "RM-027", "RM-040", "RM-014", "RM-037", "RM-019", "RM-043", "RM-032", "RM-021", "RM-046", "RM-018", "RM-022", "RM-029", "RM-012", "RM-049", "RM-023", "RM-024", "RM-041", "RM-050", "RM-044", "RM-039", "RM-042", "RM-036", "RM-017", "RM-011", "RM-013", "RM-035", "RM-030", "RM-048", "RM-026"]}, "RM-010": {"ancestors": ["RM-002", "RM-009", "RM-006", "RM-001", "RM-003", "RM-005", "RM-004"], "descendants": ["RM-025", "RM-015", "RM-028", "RM-031", "RM-020", "RM-047", "RM-016", "RM-027", "RM-040", "RM-014", "RM-037", "RM-019", "RM-043", "RM-032", "RM-021", "RM-046", "RM-018", "RM-022", "RM-029", "RM-012", "RM-049", "RM-023", "RM-024", "RM-041", "RM-050", "RM-044", "RM-039", "RM-042", "RM-036", "RM-017", "RM-011", "RM-013", "RM-035", "RM-030", "RM-048", "RM-026"]}, "RM-011": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-001", "RM-003", "RM-005", "RM-004"], "descendants": ["RM-012", "RM-019", "RM-049", "RM-046", "RM-040", "RM-050", "RM-030"]}, "RM-012": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-001", "RM-003", "RM-011", "RM-005", "RM-004"], "descendants": ["RM-050"]}, "RM-013": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-001", "RM-003", "RM-005", "RM-004"], "descendants": ["RM-025", "RM-015", "RM-028", "RM-031", "RM-020", "RM-047", "RM-016", "RM-027", "RM-040", "RM-014", "RM-019", "RM-043", "RM-032", "RM-046", "RM-018", "RM-029", "RM-049", "RM-024", "RM-041", "RM-050", "RM-044", "RM-039", "RM-017", "RM-035", "RM-030", "RM-048"]}, "RM-014": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-001", "RM-003", "RM-005", "RM-013", "RM-004"], "descendants": ["RM-019", "RM-028", "RM-044", "RM-039", "RM-017", "RM-027", "RM-046", "RM-018", "RM-050", "RM-030", "RM-029"]}, "RM-015": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-001", "RM-003", "RM-005", "RM-013", "RM-004"], "descendants": ["RM-050"]}, "RM-016": {"ancestors": ["RM-002", "RM-009", "RM-020", "RM-010", "RM-006", "RM-001", "RM-003", "RM-005", "RM-013", "RM-004"], "descendants": ["RM-050"]}, "RM-017": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-001", "RM-003", "RM-014", "RM-013", "RM-005", "RM-004"], "descendants": ["RM-050", "RM-030", "RM-039", "RM-029"]}, "RM-018": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-001", "RM-003", "RM-014", "RM-013", "RM-005", "RM-004"], "descendants": ["RM-030", "RM-050"]}, "RM-019": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-001", "RM-003", "RM-011", "RM-014", "RM-013", "RM-005", "RM-004"], "descendants": ["RM-030", "RM-050", "RM-046"]}, "RM-020": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-001", "RM-003", "RM-005", "RM-013", "RM-004"], "descendants": ["RM-028", "RM-044", "RM-039", "RM-046", "RM-027", "RM-016", "RM-050", "RM-029"]}, "RM-021": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-001", "RM-003", "RM-005", "RM-022", "RM-004"], "descendants": ["RM-025", "RM-028", "RM-031", "RM-047", "RM-027", "RM-040", "RM-037", "RM-043", "RM-046", "RM-049", "RM-023", "RM-024", "RM-041", "RM-050", "RM-044", "RM-042", "RM-036", "RM-035", "RM-048", "RM-026"]}, "RM-022": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-001", "RM-003", "RM-005", "RM-004"], "descendants": ["RM-025", "RM-028", "RM-031", "RM-047", "RM-027", "RM-040", "RM-037", "RM-043", "RM-021", "RM-046", "RM-049", "RM-023", "RM-024", "RM-041", "RM-050", "RM-044", "RM-042", "RM-036", "RM-035", "RM-048", "RM-026"]}, "RM-023": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-021", "RM-001", "RM-003", "RM-005", "RM-022", "RM-004"], "descendants": ["RM-025", "RM-043", "RM-028", "RM-044", "RM-031", "RM-049", "RM-036", "RM-047", "RM-027", "RM-046", "RM-024", "RM-041", "RM-050", "RM-035", "RM-037", "RM-048", "RM-026"]}, "RM-024": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-023", "RM-021", "RM-001", "RM-003", "RM-005", "RM-022", "RM-004", "RM-013"], "descendants": ["RM-025", "RM-028", "RM-044", "RM-031", "RM-027", "RM-050"]}, "RM-025": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-023", "RM-021", "RM-001", "RM-003", "RM-024", "RM-005", "RM-013", "RM-022", "RM-004"], "descendants": ["RM-050"]}, "RM-026": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-023", "RM-021", "RM-001", "RM-003", "RM-005", "RM-022", "RM-004"], "descendants": ["RM-050"]}, "RM-027": {"ancestors": ["RM-002", "RM-009", "RM-020", "RM-010", "RM-006", "RM-023", "RM-021", "RM-001", "RM-003", "RM-024", "RM-014", "RM-013", "RM-005", "RM-022", "RM-004"], "descendants": ["RM-028", "RM-044", "RM-050"]}, "RM-028": {"ancestors": ["RM-002", "RM-009", "RM-020", "RM-033", "RM-010", "RM-001", "RM-034", "RM-023", "RM-027", "RM-021", "RM-024", "RM-006", "RM-003", "RM-014", "RM-013", "RM-005", "RM-022", "RM-004"], "descendants": ["RM-050"]}, "RM-029": {"ancestors": ["RM-002", "RM-009", "RM-020", "RM-033", "RM-010", "RM-006", "RM-034", "RM-017", "RM-001", "RM-003", "RM-014", "RM-013", "RM-005", "RM-004"], "descendants": ["RM-050", "RM-039"]}, "RM-030": {"ancestors": ["RM-019", "RM-002", "RM-009", "RM-032", "RM-010", "RM-033", "RM-006", "RM-017", "RM-034", "RM-001", "RM-003", "RM-011", "RM-018", "RM-014", "RM-013", "RM-005", "RM-004"], "descendants": ["RM-050"]}, "RM-031": {"ancestors": ["RM-002", "RM-009", "RM-033", "RM-010", "RM-023", "RM-034", "RM-021", "RM-006", "RM-001", "RM-024", "RM-003", "RM-005", "RM-022", "RM-004", "RM-013"], "descendants": ["RM-050"]}, "RM-032": {"ancestors": ["RM-002", "RM-009", "RM-033", "RM-010", "RM-006", "RM-034", "RM-001", "RM-003", "RM-005", "RM-013", "RM-004"], "descendants": ["RM-030", "RM-047", "RM-050"]}, "RM-033": {"ancestors": [], "descendants": ["RM-028", "RM-039", "RM-032", "RM-031", "RM-047", "RM-034", "RM-045", "RM-050", "RM-030", "RM-029"]}, "RM-034": {"ancestors": ["RM-033"], "descendants": ["RM-028", "RM-039", "RM-032", "RM-031", "RM-047", "RM-045", "RM-050", "RM-030", "RM-029"]}, "RM-035": {"ancestors": ["RM-043", "RM-002", "RM-009", "RM-010", "RM-006", "RM-023", "RM-021", "RM-001", "RM-003", "RM-041", "RM-005", "RM-013", "RM-022", "RM-004"], "descendants": ["RM-048", "RM-043", "RM-050"]}, "RM-036": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-023", "RM-001", "RM-021", "RM-003", "RM-005", "RM-022", "RM-004"], "descendants": ["RM-037", "RM-047", "RM-050", "RM-046"]}, "RM-037": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-023", "RM-036", "RM-001", "RM-021", "RM-003", "RM-005", "RM-022", "RM-004"], "descendants": ["RM-050"]}, "RM-038": {"ancestors": ["RM-002", "RM-003", "RM-001", "RM-005", "RM-004"], "descendants": ["RM-050"]}, "RM-039": {"ancestors": ["RM-002", "RM-009", "RM-020", "RM-033", "RM-010", "RM-006", "RM-017", "RM-034", "RM-001", "RM-003", "RM-014", "RM-013", "RM-005", "RM-004", "RM-029"], "descendants": ["RM-050"]}, "RM-040": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-021", "RM-001", "RM-003", "RM-011", "RM-005", "RM-022", "RM-004", "RM-013"], "descendants": ["RM-050"]}, "RM-041": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-023", "RM-021", "RM-001", "RM-003", "RM-005", "RM-013", "RM-022", "RM-004"], "descendants": ["RM-043", "RM-049", "RM-050", "RM-035", "RM-048"]}, "RM-042": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-021", "RM-001", "RM-003", "RM-005", "RM-022", "RM-004"], "descendants": ["RM-050"]}, "RM-043": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-023", "RM-021", "RM-001", "RM-003", "RM-041", "RM-005", "RM-013", "RM-035", "RM-022", "RM-004"], "descendants": ["RM-035", "RM-050", "RM-048"]}, "RM-044": {"ancestors": ["RM-002", "RM-009", "RM-020", "RM-010", "RM-006", "RM-023", "RM-021", "RM-001", "RM-027", "RM-003", "RM-024", "RM-013", "RM-014", "RM-022", "RM-005", "RM-004"], "descendants": ["RM-050"]}, "RM-045": {"ancestors": ["RM-033", "RM-034"], "descendants": ["RM-050"]}, "RM-046": {"ancestors": ["RM-019", "RM-002", "RM-009", "RM-020", "RM-010", "RM-006", "RM-036", "RM-023", "RM-001", "RM-021", "RM-003", "RM-011", "RM-014", "RM-013", "RM-005", "RM-022", "RM-004"], "descendants": ["RM-050"]}, "RM-047": {"ancestors": ["RM-002", "RM-009", "RM-032", "RM-010", "RM-033", "RM-023", "RM-036", "RM-034", "RM-001", "RM-021", "RM-006", "RM-003", "RM-005", "RM-013", "RM-022", "RM-004"], "descendants": ["RM-050"]}, "RM-048": {"ancestors": ["RM-043", "RM-002", "RM-009", "RM-010", "RM-006", "RM-023", "RM-021", "RM-001", "RM-003", "RM-041", "RM-005", "RM-013", "RM-035", "RM-022", "RM-004"], "descendants": ["RM-050"]}, "RM-049": {"ancestors": ["RM-002", "RM-009", "RM-010", "RM-006", "RM-023", "RM-001", "RM-003", "RM-021", "RM-011", "RM-041", "RM-005", "RM-013", "RM-022", "RM-004"], "descendants": ["RM-050"]}, "RM-050": {"ancestors": ["RM-025", "RM-015", "RM-028", "RM-009", "RM-031", "RM-020", "RM-010", "RM-047", "RM-016", "RM-027", "RM-038", "RM-045", "RM-040", "RM-014", "RM-035", "RM-008", "RM-037", "RM-004", "RM-019", "RM-043", "RM-002", "RM-032", "RM-021", "RM-034", "RM-046", "RM-018", "RM-005", "RM-022", "RM-029", "RM-012", "RM-049", "RM-033", "RM-006", "RM-023", "RM-024", "RM-041", "RM-044", "RM-039", "RM-042", "RM-003", "RM-001", "RM-017", "RM-036", "RM-011", "RM-013", "RM-007", "RM-030", "RM-048", "RM-026"], "descendants": []}};
        const areaColors = {"Ingesta": "#4ECDC4", "Extracci\u00f3n": "#FF6B6B", "Modelo de datos": "#45B7D1", "Normalizaci\u00f3n": "#96CEB4", "Transformaci\u00f3n": "#96CEB4", "M\u00e9tricas": "#FFD93D", "Dataset": "#DDA0DD", "Algoritmo": "#98D8C8", "Backtest": "#F7DC6F", "Reportes": "#BB8FCE", "UI/UX": "#85C1E9", "Dashboard": "#85C1E9", "Seguridad": "#F1948A", "Observabilidad": "#ABEBC6", "Testing": "#F5B041", "DevOps": "#AED6F1", "Gobernanza de datos": "#D7BDE2", "Gobernanza": "#D7BDE2", "Privacidad": "#FADBD8", "Documentaci\u00f3n": "#D5DBDB", "Extensibilidad": "#A9DFBF", "Entregables": "#FAD7A0", "UX": "#85C1E9", "Calidad de datos": "#82E0AA", "Auditabilidad": "#F9E79F", "Exportaci\u00f3n": "#D2B4DE", "Reproducibilidad": "#AEB6BF", "Performance": "#F5CBA7", "Validaci\u00f3n de algoritmo": "#76D7C4"};

        let selectedNodeId = null;
        let allNodes = null;
        let allEdges = null;
        let currentLayout = 'force';
        const hoverTooltip = document.getElementById('hover-tooltip');

        // Store original data after network is ready
        network.once('stabilizationIterationsDone', function() {
            allNodes = nodes.get();
            allEdges = edges.get();
        });

        // Node click handler
        network.on('click', function(params) {
            if (params.nodes.length > 0) {
                selectedNodeId = params.nodes[0];
                updateStats(selectedNodeId);
                showNodeInfo(selectedNodeId);
            } else {
                selectedNodeId = null;
                updateStats(null);
                closeNodeInfo();
            }
        });

        // Hover tooltip handlers
        network.on('hoverNode', function(params) {
            const nodeId = params.node;
            const data = nodeData[nodeId];
            if (!data) return;

            const color = areaColors[data.area] || '#888888';
            hoverTooltip.innerHTML = `
                <h4 style="color: ${color}">${nodeId}: ${data.funcionalidad}</h4>
                <div class="tooltip-row">
                    <span class="tooltip-label">√Årea:</span>
                    <span class="tooltip-value">${data.area}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Prioridad:</span>
                    <span class="tooltip-value">${data.prioridad}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Versi√≥n:</span>
                    <span class="tooltip-value">${data.version}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Estatus:</span>
                    <span class="tooltip-value">${data.estatus}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Owner:</span>
                    <span class="tooltip-value">${data.owner}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Roles:</span>
                    <span class="tooltip-value">${data.roles}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Dependencias:</span>
                    <span class="tooltip-value">${data.dependencias}</span>
                </div>
                <div class="tooltip-requisito">
                    <span class="tooltip-requisito-label">Requisito:</span>
                    ${data.requisito}
                </div>
            `;
            hoverTooltip.style.display = 'block';
        });

        network.on('blurNode', function() {
            hoverTooltip.style.display = 'none';
        });

        // Update tooltip position on mouse move
        document.getElementById('mynetwork').addEventListener('mousemove', function(e) {
            if (hoverTooltip.style.display === 'block') {
                const x = e.clientX + 15;
                const y = e.clientY + 15;
                const tooltipRect = hoverTooltip.getBoundingClientRect();

                // Keep tooltip within viewport
                const maxX = window.innerWidth - tooltipRect.width - 20;
                const maxY = window.innerHeight - tooltipRect.height - 20;

                hoverTooltip.style.left = Math.min(x, maxX) + 'px';
                hoverTooltip.style.top = Math.min(y, maxY) + 'px';
            }
        });

        function updateStats(nodeId) {
            document.getElementById('selected-node').textContent = nodeId || '‚Äî';
            if (nodeId && nodeData[nodeId]) {
                document.getElementById('in-degree').textContent = nodeData[nodeId].in_degree;
                document.getElementById('out-degree').textContent = nodeData[nodeId].out_degree;
            } else {
                document.getElementById('in-degree').textContent = '‚Äî';
                document.getElementById('out-degree').textContent = '‚Äî';
            }
        }

        function showNodeInfo(nodeId) {
            const data = nodeData[nodeId];
            const subgraph = subgraphData[nodeId];
            if (!data) return;

            document.getElementById('info-title').textContent = nodeId + ': ' + data.funcionalidad;
            document.getElementById('info-content').innerHTML = `
                <p><strong>√Årea:</strong> ${data.area}</p>
                <p><strong>Prioridad:</strong> ${data.prioridad}</p>
                <p><strong>Versi√≥n:</strong> ${data.version}</p>
                <p><strong>Estatus:</strong> ${data.estatus}</p>
                <p><strong>Owner:</strong> ${data.owner}</p>
                <hr style="border-color: #4a4a6a; margin: 10px 0;">
                <p><strong>Dependencias directas:</strong> ${data.in_degree}</p>
                <p><strong>Dependientes directos:</strong> ${data.out_degree}</p>
                <p><strong>Total ancestros:</strong> ${subgraph.ancestors.length}</p>
                <p><strong>Total descendientes:</strong> ${subgraph.descendants.length}</p>
            `;
            document.getElementById('node-info').style.display = 'block';
        }

        function closeNodeInfo() {
            document.getElementById('node-info').style.display = 'none';
        }

        // Layout switching
        function setLayout(layout) {
            currentLayout = layout;

            // Update button states
            document.getElementById('layout-force').classList.toggle('active', layout === 'force');
            document.getElementById('layout-tree').classList.toggle('active', layout === 'tree');

            if (layout === 'tree') {
                // Hierarchical layout
                network.setOptions({
                    layout: {
                        hierarchical: {
                            enabled: true,
                            direction: 'UD',
                            sortMethod: 'directed',
                            levelSeparation: 120,
                            nodeSpacing: 150,
                            treeSpacing: 200,
                            blockShifting: true,
                            edgeMinimization: true,
                            parentCentralization: true
                        }
                    },
                    physics: {
                        enabled: false
                    }
                });
            } else {
                // Force-directed layout
                network.setOptions({
                    layout: {
                        hierarchical: {
                            enabled: false
                        }
                    },
                    physics: {
                        enabled: true,
                        solver: 'forceAtlas2Based',
                        forceAtlas2Based: {
                            gravitationalConstant: -80,
                            centralGravity: 0.01,
                            springLength: 150,
                            springConstant: 0.08,
                            damping: 0.4,
                            avoidOverlap: 0.8
                        },
                        stabilization: {
                            enabled: true,
                            iterations: 200,
                            updateInterval: 25
                        }
                    }
                });
            }

            // Fit view after layout change
            setTimeout(() => {
                network.fit({ animation: { duration: 500 } });
            }, 300);
        }

        function focusNode() {
            const nodeId = document.getElementById('node-search').value.toUpperCase();
            if (nodes.get(nodeId)) {
                network.focus(nodeId, {
                    scale: 1.5,
                    animation: { duration: 500, easingFunction: 'easeInOutQuad' }
                });
                network.selectNodes([nodeId]);
                selectedNodeId = nodeId;
                updateStats(nodeId);
                showNodeInfo(nodeId);
            } else {
                alert('Nodo no encontrado: ' + nodeId);
            }
        }

        function filterByArea(area) {
            document.getElementById('area-filter').value = area;
            applyFilters();
        }

        function applyFilters() {
            const areaFilter = document.getElementById('area-filter').value;
            const priorityFilter = document.getElementById('priority-filter').value;
            const versionFilter = document.getElementById('version-filter').value;

            if (!allNodes) allNodes = nodes.get();
            if (!allEdges) allEdges = edges.get();

            // Filter nodes
            const visibleNodeIds = new Set();
            allNodes.forEach(node => {
                const data = nodeData[node.id];
                if (!data) return;

                const matchArea = !areaFilter || data.area === areaFilter;
                const matchPriority = !priorityFilter || data.prioridad === priorityFilter;
                const matchVersion = !versionFilter || data.version === versionFilter;

                if (matchArea && matchPriority && matchVersion) {
                    visibleNodeIds.add(node.id);
                }
            });

            // Update node visibility
            const updates = allNodes.map(node => ({
                id: node.id,
                hidden: !visibleNodeIds.has(node.id)
            }));
            nodes.update(updates);

            // Update edge visibility
            const edgeUpdates = allEdges.map(edge => ({
                id: edge.id,
                hidden: !visibleNodeIds.has(edge.from) || !visibleNodeIds.has(edge.to)
            }));
            edges.update(edgeUpdates);

            // Update stats
            const visibleEdges = allEdges.filter(e =>
                visibleNodeIds.has(e.from) && visibleNodeIds.has(e.to)
            ).length;

            document.getElementById('visible-nodes').textContent = visibleNodeIds.size;
            document.getElementById('visible-edges').textContent = visibleEdges;
        }

        function showAncestors() {
            if (!selectedNodeId) {
                alert('Selecciona un nodo primero');
                return;
            }
            showAncestorsOf(selectedNodeId);
        }

        function showAncestorsOf(nodeId) {
            const ancestors = subgraphData[nodeId]?.ancestors || [];
            const visibleIds = new Set([nodeId, ...ancestors]);
            showSubgraph(visibleIds, 'Dependencias de ' + nodeId);
        }

        function showDescendants() {
            if (!selectedNodeId) {
                alert('Selecciona un nodo primero');
                return;
            }
            showDescendantsOf(selectedNodeId);
        }

        function showDescendantsOf(nodeId) {
            const descendants = subgraphData[nodeId]?.descendants || [];
            const visibleIds = new Set([nodeId, ...descendants]);
            showSubgraph(visibleIds, 'Dependientes de ' + nodeId);
        }

        function showNeighborhood() {
            if (!selectedNodeId) {
                alert('Selecciona un nodo primero');
                return;
            }

            // Get immediate neighbors only (depth 1)
            const neighbors = new Set([selectedNodeId]);
            allEdges.forEach(edge => {
                if (edge.from === selectedNodeId) neighbors.add(edge.to);
                if (edge.to === selectedNodeId) neighbors.add(edge.from);
            });

            showSubgraph(neighbors, 'Vecindario de ' + selectedNodeId);
        }

        function showSubgraph(visibleIds, title) {
            if (!allNodes) allNodes = nodes.get();
            if (!allEdges) allEdges = edges.get();

            // Update nodes
            const updates = allNodes.map(node => ({
                id: node.id,
                hidden: !visibleIds.has(node.id)
            }));
            nodes.update(updates);

            // Update edges
            const edgeUpdates = allEdges.map(edge => ({
                id: edge.id,
                hidden: !visibleIds.has(edge.from) || !visibleIds.has(edge.to)
            }));
            edges.update(edgeUpdates);

            // Update stats
            const visibleEdges = allEdges.filter(e =>
                visibleIds.has(e.from) && visibleIds.has(e.to)
            ).length;

            document.getElementById('visible-nodes').textContent = visibleIds.size;
            document.getElementById('visible-edges').textContent = visibleEdges;

            // Fit view
            network.fit({ animation: { duration: 500 } });
        }

        function resetView() {
            // Clear filters
            document.getElementById('area-filter').value = '';
            document.getElementById('priority-filter').value = '';
            document.getElementById('version-filter').value = '';
            document.getElementById('node-search').value = '';

            if (!allNodes) allNodes = nodes.get();
            if (!allEdges) allEdges = edges.get();

            // Show all nodes
            const updates = allNodes.map(node => ({ id: node.id, hidden: false }));
            nodes.update(updates);

            // Show all edges
            const edgeUpdates = allEdges.map(edge => ({ id: edge.id, hidden: false }));
            edges.update(edgeUpdates);

            // Update stats
            document.getElementById('visible-nodes').textContent = allNodes.length;
            document.getElementById('visible-edges').textContent = allEdges.length;

            // Deselect
            network.unselectAll();
            selectedNodeId = null;
            updateStats(null);
            closeNodeInfo();

            // Reset layout to force if needed and fit view
            if (currentLayout === 'force') {
                network.stabilize();
            }
            network.fit({ animation: { duration: 500 } });
        }

        // Add event listeners to filters
        document.getElementById('area-filter').addEventListener('change', applyFilters);
        document.getElementById('priority-filter').addEventListener('change', applyFilters);
        document.getElementById('version-filter').addEventListener('change', applyFilters);

        // Enter key for search
        document.getElementById('node-search').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') focusNode();
        });
    </script>
    </body>
</html>